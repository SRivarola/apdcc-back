import{f as S,u as D,j as e,b as M,m as P,a as E,A as T,r as h,s as I,g as B}from"./index-WqbPWE0E.js";import{h as C}from"./moment-WSJ9un1t.js";import{P as K}from"./pen-square-aFwKzsj7.js";import{m as F}from"./chunk-3S23ARPO-eiL4WC3X.js";import{m as L}from"./chunk-EPDLEVDR-54dcRee3.js";import{m as O}from"./chunk-QY5NICTW-_zE6iGR2.js";import{i as y}from"./chunk-TC4QW7OA-v-iVWaFn.js";import{t as G}from"./chunk-K3TANQWH-pElV0bqR.js";import{s as q,l as H}from"./chunk-ZFWMN6TD-2mDsgrVL.js";import{c as J}from"./chunk-OFH6WYRQ-oWe43lFJ.js";function ee({round:u}){const{setRefresh:s}=S(),{isOpen:i,onOpen:x,onOpenChange:v}=D(),c=async m=>{const f=localStorage.getItem("apdcc_token");T.promise(async()=>{try{if((await fetch(`https://apdcc-back-production.up.railway.app/api/matches/tournament/${u[0].tournament_id}`,{method:"PUT",credentials:"include",headers:{token:f,body:JSON.stringify({round:u[0].round})}})).ok)return s(),m(),"¡Edición Exitosa! 😄";throw new Error("Oops, algo salió mal 😕")}catch(t){throw new Error(t)}},{loading:"Loading...",success:t=>t,error:t=>t.message})};return e.jsxs(e.Fragment,{children:[e.jsx(M,{isIconOnly:!0,onPress:x,color:"default",size:"sm",className:"bg-default/50 text-default-400 hover:text-white",children:e.jsx(K,{size:18})}),e.jsx(P,{isOpen:i,size:"lg",onOpenChange:v,backdrop:"blur",className:"border dark text-foreground border-default-400",children:e.jsx(E,{children:m=>e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Advertencia"}),e.jsxs(L,{className:"max-w-5xl",children:[e.jsx("p",{children:"Esta acción es permanente y no se puede deshacer."}),e.jsx("p",{className:"text-warning",children:"Se cambiaran todas las fechas a partir de la actual, 1 (una) semana hacia adelante."}),e.jsxs("p",{children:["Fecha Actual: ",C(u[0].date).add(1,"days").format("DD-MM-YYYY")]}),e.jsxs("p",{children:["Nueva Fecha: ",C(u[0].date).add(8,"days").format("DD-MM-YYYY")]})]}),e.jsx(O,{children:e.jsx(M,{className:"z-0 order-last w-full font-semibold uppercase bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",onPress:()=>c(m),children:"Editar"})})]})})})]})}const ae=e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-scoreboard",width:"24",height:"24",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M3 5m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z"}),e.jsx("path",{d:"M12 5v2"}),e.jsx("path",{d:"M12 10v1"}),e.jsx("path",{d:"M12 14v1"}),e.jsx("path",{d:"M12 18v1"}),e.jsx("path",{d:"M7 3v2"}),e.jsx("path",{d:"M17 3v2"}),e.jsx("path",{d:"M15 10.5v3a1.5 1.5 0 0 0 3 0v-3a1.5 1.5 0 0 0 -3 0z"}),e.jsx("path",{d:"M6 9h1.5a1.5 1.5 0 0 1 0 3h-.5h.5a1.5 1.5 0 0 1 0 3h-1.5"})]}),U=e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"flex-shrink-0 pointer-events-none icon icon-tabler icon-tabler-ball-football text-default-400",width:"22",height:"22",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),e.jsx("path",{d:"M12 7l4.76 3.45l-1.76 5.55h-6l-1.76 -5.55z"}),e.jsx("path",{d:"M12 7v-4m3 13l2.5 3m-.74 -8.55l3.74 -1.45m-11.44 7.05l-2.56 2.95m.74 -8.55l-3.74 -1.45"})]});function se({isOpen:u,onOpenChange:s,match:i,tournamentId:x}){const v=localStorage.getItem("apdcc_token"),{setRefresh:c}=S(),[m,f]=h.useState({res_local:0,res_visit:0}),[t,o]=h.useState({red_card:0,yellow_card:0,message:""}),[n,d]=h.useState({red_card:0,yellow_card:0,message:""}),[j,N]=h.useState(null),[_,k]=h.useState([]),[b,$]=h.useState([]),[R,Q]=h.useState([]),[A,X]=h.useState([]);h.useEffect(()=>{i&&(async()=>{try{const p=await fetch(`https://apdcc-back-production.up.railway.app/api/targets/tournament/${x}/match/${i._id}`);if(!p.ok){console.log("Algo salio mal en el fetch");return}const{response:r}=await p.json(),g=r.find(a=>a.team_id._id===i.local.team_id._id),w=r.find(a=>a.team_id._id===i.visit.team_id._id);N({local:g._id,visit:w._id})}catch(p){console.error(p)}})()},[x,i._id]),h.useEffect(()=>{const l=async(p,r)=>{try{const g=await fetch(`https://apdcc-back-production.up.railway.app/api/players/all/?team=${p}`,{method:"GET",credentials:"include",headers:{token:v}});if(console.log("response",g),g.ok){const{response:w}=await g.json();r?Q(w):X(w)}}catch(g){throw new Error(g)}};t.red_card>0&&l(i.local.team_id._id,!0),n.red_card>0&&l(i.visit.team_id._id,!1)},[t,n]);const V=l=>{f({...m,[l.target.name]:Number(l.target.value)||0})},z=l=>{l.target.name==="message"?o({...t,message:l.target.value}):o({...t,[l.target.name]:Number(l.target.value)||0})},Y=l=>{l.target.name==="message"?d({...n,message:l.target.value}):d({...n,[l.target.name]:Number(l.target.value)||0})},W=(l,p)=>{const r=l.target.value;if(p){if(_.includes(r)){k(r.split(","));return}if(_.length<t.red_card){r==""?k([]):k(r.split(","));return}}else{if(b.includes(r)){$(r.split(","));return}if(b.length<n.red_card){r==""?$([]):$(r.split(","));return}}},Z=async l=>{const p=localStorage.getItem("apdcc_token");T.promise(async()=>{try{if((await fetch(`https://apdcc-back-production.up.railway.app/api/matches/results/${i._id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",token:p},body:JSON.stringify({results:m,targetLocal:t,targetVisit:n,targetLocal_id:j.local,targetVisit_id:j.visit,redCards:{localPlayersWithRedCards:_,visitPlayersWithRedCards:b}})})).ok)return c(),"Datos cargados con éxito 😀"}catch(r){return console.log(r),"Algo salio mal 😮‍💨"}finally{l()}},{loading:"Loading...",success:r=>r,error:r=>r.message})};return e.jsx(e.Fragment,{children:e.jsx(P,{isOpen:u,onOpenChange:s,size:"3xl",className:"w-full border dark text-foreground border-default-400",children:e.jsx(E,{children:l=>{var p,r,g,w;return e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"flex flex-col gap-1",children:"Carga de datos"}),e.jsx(L,{children:e.jsxs("div",{className:"grid grid-cols-12 gap-10",children:[e.jsxs("div",{className:"block w-full col-span-6",children:[e.jsx("h2",{className:"text-xl uppercase",children:(r=(p=i.local)==null?void 0:p.team_id)==null?void 0:r.name}),e.jsx(y,{size:"sm",variant:"underlined",type:"number",min:"0",step:"1",placeholder:"Goles anotados",startContent:U,defaultValue:0,name:"res_local",onChange:a=>V(a)}),e.jsx(y,{size:"sm",variant:"underlined",type:"number",min:"0",step:"1",placeholder:"Tarjetas Amarillas",startContent:e.jsx("span",{children:"🟨"}),defaultValue:0,name:"yellow_card",onChange:a=>z(a)}),e.jsx(y,{size:"sm",type:"number",variant:"underlined",min:"0",step:"1",placeholder:"Tarjetas Rojas",startContent:e.jsx("span",{children:"🟥"}),defaultValue:0,name:"red_card",onChange:a=>z(a)}),e.jsx(G,{placeholder:"Mensaje",className:"pt-5 ",name:"message",onChange:a=>z(a)}),t.red_card>0&&R.length?e.jsx(q,{label:"Asignar tarjeta roja",isRequired:!0,className:"col-span-4",variant:"underlined",selectionMode:t.red_card>1?"multiple":"single",isDisabled:t.red_card===_.length,selectedKeys:_,onChange:a=>W(a,!0),children:R.map(a=>e.jsx(H,{value:a._id,children:`${a.first_name+" "+a.last_name}`},`${a._id}`))}):t.red_card>0?e.jsx("div",{className:"flex justify-center w-full mt-3",children:e.jsx(I,{})}):null]}),e.jsxs("div",{className:"block w-full col-span-6",children:[e.jsx("h2",{className:"text-xl uppercase",children:(w=(g=i.visit)==null?void 0:g.team_id)==null?void 0:w.name}),e.jsx(y,{size:"sm",type:"number",variant:"underlined",min:"0",step:"1",placeholder:"Goles anotados",startContent:U,defaultValue:0,name:"res_visit",onChange:a=>V(a)}),e.jsx(y,{size:"sm",variant:"underlined",type:"number",min:"0",step:"1",placeholder:"Tarjetas Amarillas",startContent:e.jsx("span",{children:"🟨"}),defaultValue:0,name:"yellow_card",onChange:a=>Y(a)}),e.jsx(y,{size:"sm",type:"number",variant:"underlined",min:"0",step:"1",placeholder:"Tarjetas Rojas",startContent:e.jsx("span",{children:"🟥"}),defaultValue:0,name:"red_card",onChange:a=>Y(a)}),e.jsx(G,{placeholder:"Mensaje",className:"pt-5 ",name:"message",onChange:a=>Y(a)}),n.red_card>0&&A.length?e.jsx(q,{label:"Asignar tarjeta roja",isRequired:!0,className:"col-span-4",variant:"underlined",selectedKeys:b,isDisabled:n.red_card===b.length,selectionMode:n.red_card>1?"multiple":"single",onChange:a=>W(a,!1),children:A.map(a=>e.jsx(H,{value:a._id,children:`${a.first_name+" "+a.last_name}`},`${a._id}`))}):n.red_card>0?e.jsx("div",{className:"flex justify-center w-full mt-3",children:e.jsx(I,{})}):null]})]})}),e.jsx(O,{children:e.jsx(M,{className:"z-0 order-last w-full font-semibold uppercase bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",startContent:ae,onPress:()=>{Z(l)},children:"Guardar"})})]})}})})})}function te({match:u}){const{setRefresh:s}=S(),{isOpen:i,onOpen:x,onOpenChange:v}=D(),[c,m]=h.useState({date:"",time:""}),f=o=>{const{name:n,value:d}=o.target;if(n==="date"){const j=new Date(o.target.value),N=C(j).format("MM-DD-YYYY");m({...c,date:N})}if(n==="time"){const j=o.target.value+"hs";m({...c,time:j})}m({...c,[n]:d})};async function t(o){const n=localStorage.getItem("apdcc_token");T.promise(async()=>{try{if((await fetch(`https://apdcc-back-production.up.railway.app/api/matches/match/${u._id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",token:n},body:JSON.stringify(c)})).ok)return s(),o(),"Datos modificados con éxito 😀"}catch(d){console.log(d)}},{loading:"Loading...",success:d=>d,error:d=>d.message})}return e.jsxs(e.Fragment,{children:[e.jsx(M,{isIconOnly:!0,color:"default",onPress:x,size:"sm",className:"w-fit bg-default/50 text-default-400 hover:text-white my-auto",children:e.jsx(K,{size:18})}),e.jsx(P,{isOpen:i,size:"2xl",onOpenChange:v,backdrop:"blur",className:"border dark text-foreground border-default-400",children:e.jsx(E,{children:o=>e.jsxs(e.Fragment,{children:[e.jsx(F,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Advertencia"}),e.jsxs(L,{className:"max-w-5xl",children:[e.jsx("p",{children:"Esta acción es permanente y no se puede deshacer."}),e.jsxs("p",{children:["Fecha Actual: ",C(u.date).add(1,"days").format("DD-MM-YYYY")]}),e.jsxs("p",{children:["Horario Actual: ",u.time]}),e.jsx(y,{id:"date",type:"date",name:"date",value:c.data,onChange:f}),e.jsx(y,{id:"time",type:"time",name:"time",value:c.time,onChange:f})]}),e.jsx(O,{children:e.jsx(M,{className:"z-0 order-last w-full font-semibold uppercase bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",onPress:()=>t(o),children:"Editar"})})]})})})]})}const re=function({match:s,tournamentId:i,i:x}){var o,n,d,j,N,_,k,b;const c=B().pathname,{isOpen:m,onOpen:f,onOpenChange:t}=D();return e.jsxs("div",{className:`flex ${x%2===0?"flex-row":"flex-row-reverse"} gap-2 items-stretch`,children:[c.startsWith("/dashboard")?e.jsx(te,{match:s}):null,e.jsxs("div",{className:`${(o=s==null?void 0:s.res_local)!=null&&o.toString()&&((n=s==null?void 0:s.res_visit)!=null&&n.toString())?"pointer-events-none border-success/40":""} grid items-center grid-cols-3 col-span-2 gap-2 lg:gap-5 px-5 py-3 m-3 text-center transition-transform duration-150 ease-linear border rounded-lg  md:col-span-1 border-default-200 bg-gradient-to-br from-white to-default-200 dark:from-default-50 dark:to-black ${c.startsWith("/dashboard")&&"hover:scale-105 cursor-pointer"} relative w-full`,onClick:f,children:[e.jsx("p",{className:"col-start-1 text-sm text-default-400",children:"Local"}),e.jsx("p",{className:"col-start-2 mb-auto text-sm lg:text-base",children:C(s.date).add(1,"days").format("DD-MM-YYYY")}),e.jsxs("div",{className:"flex flex-col items-center col-start-1 row-start-2 min-h-24",children:[e.jsx("p",{className:"text-xs font-semibold uppercase lg:text-sm lg:font-bold",children:((j=(d=s.local)==null?void 0:d.team_id)==null?void 0:j.name)||e.jsx(J,{variant:"flat",color:"warning",children:"fecha libre"})}),(N=s==null?void 0:s.res_local)!=null&&N.toString()?e.jsx("span",{className:"text-xl font-bold lg:text-2xl",children:s.res_local}):null]}),e.jsx("div",{className:"flex flex-col items-center justify-between col-start-2 row-start-2 gap-3 my-auto",children:e.jsx("span",{className:" text-warning",children:"vs"})}),e.jsx("p",{className:"col-start-3 text-sm text-default-400",children:"Visitante"}),e.jsxs("div",{className:"relative flex flex-col items-center col-start-3 row-start-2",children:[e.jsx("p",{className:"text-xs font-bold uppercase lg:text-sm",children:((k=(_=s.visit)==null?void 0:_.team_id)==null?void 0:k.name)||e.jsx(J,{variant:"flat",color:"warning",children:"fecha libre"})}),(b=s==null?void 0:s.res_visit)!=null&&b.toString()?e.jsx("span",{className:"text-xl font-bold lg:text-2xl",children:s.res_visit}):null]})]}),c.startsWith("/dashboard")&&e.jsx(se,{isOpen:m,onOpenChange:t,match:s,tournamentId:i})]})},ne=re;function le({round:u,tournamentId:s}){return e.jsx(e.Fragment,{children:u.map((i,x)=>e.jsx(ne,{match:i,tournamentId:s,i:x},x))})}const oe=function({matches:s,tournamentId:i}){const v=B().pathname,{refresh:c}=S(),[m,f]=h.useState([]);return h.useEffect(()=>{const t=Object.values(s.reduce((o,n)=>{const d=n.round;return o[d]||(o[d]=[]),o[d].push(n),o},{}));f(t)},[s,c]),e.jsx("div",{className:"mb-10",children:m.map((t,o)=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-center gap-2 mt-10 text-lg font-bold text-center",children:[e.jsxs("h1",{children:["Fecha ",o+1]}),v.startsWith("/dashboard")?e.jsx(ee,{round:t}):null]}),e.jsx("span",{className:"relative grid grid-cols-1 lg:grid-cols-2 lg:gap-16 mx-auto mt-5 lg:mt-10 max-w-7xl",children:e.jsx(le,{round:t,tournamentId:i})})]},`${t._id}${o+1}match`))})},je=oe;export{je as F};
