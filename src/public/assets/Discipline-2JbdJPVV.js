import{r as n,a as E,h as b,j as e,a4 as y,m as S,c as D,b as _,A as w,s as C,aa as T,a6 as $}from"./index-dASvhswz.js";import{S as k}from"./StateColumn-qjj8TWOk.js";import{m as A}from"./chunk-3S23ARPO-Jp59hHS7.js";import{m as L}from"./chunk-EPDLEVDR-Lqmna2nA.js";import{i as O}from"./chunk-TC4QW7OA-Ai8etS-S.js";import{h as N}from"./moment-WSJ9un1t.js";import{s as Y,l as M}from"./chunk-ZFWMN6TD-_2NsMkfV.js";import"./chunk-OFH6WYRQ-Nb2wLexk.js";import"./chunk-M3MASYO7-0NZ0x2Lu.js";import"./import-Ak8W0mj0.js";import"./import-1vz6IBoH.js";import"./import-MCAmqJa5.js";import"./chunk-7F3ZLNJ6-PoB6E63L.js";const v=({player:s,target:c,date:u})=>{const[t,p]=n.useState(null),{isOpen:f,onOpen:h,onOpenChange:r}=E(),{setRefresh:i}=b(),[d,g]=n.useState(),a=async()=>{try{const o=await fetch(`https://apdcc.com.ar/api/countries/${s.country_id}`,{method:"GET",credentials:"include"});if(o.ok){const{response:m}=await o.json();p(m)}}catch(o){console.log(o)}},x=async o=>{const m={state:"READY"};w.promise(async()=>{try{if((await fetch(`https://apdcc.com.ar/api/players/player/${s._id}`,{method:"PUT",credentials:"include",headers:{"Content-type":"application/json"},body:JSON.stringify(m)})).ok)return i(),o(),"¡Estado cambiado con éxito! 😄";throw new Error("Error al cambiar el estado del jugador 😕")}catch{throw new Error("Oops, algo salió mal. 😕")}},{loading:"Loading...",success:l=>l,error:l=>l.message})},j=async o=>{const m={state:"OSUSPENDED",reactivated:d};w.promise(async()=>{if(d){if((await fetch(`https://apdcc.com.ar/api/players/player/${s._id}`,{method:"PUT",credentials:"include",headers:{"Content-type":"application/json"},body:JSON.stringify(m)})).ok)return i(),o(),"¡Estado cambiado con éxito! 😄";throw new Error("Error al cambiar el estado del jugador 😕")}else throw new Error("Debe ingresar una fecha para su reactivación")},{loading:"Loading...",success:l=>l,error:l=>l.message})};return n.useEffect(()=>{a()},[s]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{onClick:h,className:"mt-1 grid grid-cols-12 w-full bg-default-50 pt-2 pb-2 rounded-md text-white border border-default-50 hover:border-white cursor-pointer",children:[e.jsx("div",{className:"col-span-3 pl-3",children:e.jsx(y,{avatarProps:{radius:"md",src:s.avatar.url},name:`${s.first_name.toLowerCase()} ${s.last_name.toLowerCase()}`,description:t!=null&&t.name?t.name:"",className:"capitalize h-full"})}),e.jsx("div",{className:"col-span-2 pl-3 flex items-center",children:u}),e.jsx("div",{className:"col-span-5 px-3 flex items-center",children:c.message||""}),e.jsx("div",{className:"col-span-2 pl-3 flex items-center",children:e.jsx(k,{item:s})})]}),e.jsx(S,{isOpen:f,size:"xl",onOpenChange:r,backdrop:"blur",className:"dark text-foreground border border-default-400",children:e.jsx(D,{children:o=>e.jsxs(e.Fragment,{children:[e.jsx(A,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Advertencia"}),e.jsxs(L,{className:"max-w-5xl",children:[e.jsxs("p",{children:["Esta seguro que quiere ",e.jsx("span",{className:"uppercase font-semibold",children:`${s.state=="OSUSPENDED"?"activar":"suspender"} `}),"al jugador",e.jsx("span",{className:"capitalize font-semibold",children:` ${s.last_name} ${s.first_name.toLowerCase()}.`})]}),s.state=="OSUSPENDED"?e.jsx(_,{className:"order-last w-full my-2 font-semibold uppercase bg-primary/60 hover:bg-primary",radius:"sm",onClick:()=>x(o),children:"ACTIVAR"}):e.jsxs("div",{className:"flex gap-2 my-2",children:[e.jsx(O,{className:"w-full rounded-sm",variant:"underlined",color:"warning",size:"xs",radius:"sm",type:"date",onChange:m=>g(m.target.value.toLocaleLowerCase())}),e.jsx(_,{radius:"sm",color:"danger",className:"w-full font-semibold uppercase bg-danger/60 hover:bg-danger",onClick:()=>j(o),children:"SUSPENDER"})]})]})]})})})]})},P=({match:s})=>{const[c,u]=n.useState(null),[t,p]=n.useState(null),{refresh:f}=b(),h=async()=>{u(null),p(null);try{const r=await fetch(`https://apdcc.com.ar/api/targets/tournament/${s.tournament_id._id}/match/${s._id}`);if(r.ok){const{response:i}=await r.json();u(i.filter(d=>d.team_id._id===s.local.team_id._id)[0]),p(i.filter(d=>d.team_id._id===s.visit.team_id._id)[0])}}catch(r){console.log(r)}};return n.useEffect(()=>{h()},[s,f]),e.jsxs("section",{className:"w-full flex flex-col",children:[c?c.red_cards.map(r=>e.jsx(v,{player:r,target:c,date:N(s.date).format("DD-MM-YYYY")},r._id)):null,t?t.red_cards.map(r=>e.jsx(v,{player:r,target:t,date:N(s.date).format("DD-MM-YYYY")},r._id)):null]})},W=()=>{const{isHiddenTopBar:s}=b(),[c,u]=n.useState([]),[t,p]=n.useState(null),[f,h]=n.useState(!0),[r,i]=n.useState([]),d=async()=>{const a=await T();if(a.ok){const{response:x}=await a.json();u(x)}h(!1)},g=async()=>{i([]);const a=await $(t==null?void 0:t.currentKey);if(!(a!=null&&a.ok)){console.log("Algo salio mal en el fetch");return}const{response:x}=await a.json();i(x.sort((j,o)=>o.date.localeCompare(j.date)))};return n.useEffect(()=>{d()},[]),n.useEffect(()=>{g()},[t]),e.jsxs("section",{className:`${s?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16 lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black text-default-400`,children:[e.jsx("div",{className:"flex justify-end",children:f?e.jsx("div",{className:"w-[350px] flex justify-center",children:e.jsx(C,{})}):e.jsx(Y,{className:"w-[350px] font-semibold",label:"Torneos",size:"sm",color:"warning",variant:"underlined",value:t,selectedKeys:t,onSelectionChange:p,children:c.map(a=>e.jsx(M,{value:a._id,children:a.name.toUpperCase()},a._id))})}),t?e.jsxs(e.Fragment,{children:[e.jsx("h1",{className:"mt-10 uppercase text-white text-2xl",children:c.find(a=>a._id==t.currentKey).name}),e.jsxs("div",{className:"mt-10 mb-1 grid grid-cols-12 text-white text-base uppercase bg-default-100 p-3 rounded-md",children:[e.jsx("div",{className:"col-span-3 border-r border-default-300 pl-2",children:"jugador"}),e.jsx("div",{className:"col-span-2 border-r border-default-300 pl-2",children:"fecha"}),e.jsx("div",{className:"col-span-5 border-r border-default-300 pl-2",children:"mensaje"}),e.jsx("div",{className:"col-span-2 pl-2",children:"estado"})]})]}):null,r.length?r.map(a=>e.jsx(P,{match:a},a._id)):null]})};export{W as default};
