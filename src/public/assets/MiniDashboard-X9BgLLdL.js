import{r as n,h as C,j as e,b as x,k as L,n as Y,a0 as A,A as _,a as v,m as N,c as w,s as q,ab as H}from"./index-iAvMSn7O.js";import{h as I}from"./moment-WSJ9un1t.js";import{i as D}from"./chunk-TC4QW7OA-awqbcFK6.js";import{s as j,l as g}from"./chunk-ZFWMN6TD-x4uwpBV7.js";import{m as E}from"./chunk-3S23ARPO-R4G7t9Cy.js";import{m as k}from"./chunk-EPDLEVDR-Zlm-YNY8.js";import{T as J}from"./trash-2-L6K-7j-z.js";import{m as B}from"./chunk-QY5NICTW-Dk-6Nbfc.js";import{P as U}from"./pen-square-zKieONUn.js";import{t as V,a as W,b as G,c as K,d as Q,e as X}from"./chunk-YRZGWF2W-jOM1iz-C.js";import{p as Z}from"./chunk-BIN3WWJN-1wdQZdcl.js";import{g as ee}from"./chunk-KARN4QIT-dIlius-J.js";import"./import-GwI392wx.js";import"./import-Sb5K26Mj.js";import"./chunk-M3MASYO7-MF5-T0bH.js";import"./import-I6dRycQZ.js";import"./chunk-7F3ZLNJ6-Lre8nyzq.js";import"./chunk-AMSULWPV-72_QTxLq.js";import"./index-taukuCH3.js";const P=({onClose:l,required:r,id:o})=>{const[c,d]=n.useState([]),[f,u]=n.useState([]),[p,i]=n.useState([]),[s,m]=n.useState({title:"",location:"",sport:"",category_id:"",date:"",list:[]}),[F,b]=n.useState(!1),{setRefresh:O}=C(),T=async()=>{try{const a=await L();if(a.ok){const t=await a.json();d(t.response)}}catch(a){throw a}},$=async()=>{try{const a=await Y();if(a.ok){const y=(await a.json()).response.filter(S=>S.name==="6-7"||S.name==="8-9");u(y)}}catch(a){throw a}},M=async()=>{try{const a=await A(`sport=${s.sport}&category_id=${s.category_id}`);if(a.ok){const t=await a.json();i(t.response)}}catch(a){throw a}},h=(a,t)=>{m(y=>({...y,[a]:t}))},R=async a=>{b(!0),a.preventDefault(),_.promise(async()=>{try{if((await fetch("https://apdcc.com.ar/api/publications/create",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)return O(),"¡Creación Exitosa! 😄";throw new Error("Oops, algo salió mal en el creación. 😕")}catch(t){console.log(t)}finally{b(!1),l()}},{loading:"Loading...",success:t=>t,error:t=>t.message})},z=async a=>{b(!0),a.preventDefault(),_.promise(async()=>{try{if((await fetch(`https://apdcc.com.ar/api/publications/${o}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)})).ok)return O(),"¡Se editó correctamente! 😄";throw new Error("Oops, algo salió mal en la edición. 😕")}catch(t){console.log(t)}finally{b(!1),l()}},{loading:"Loading...",success:t=>t,error:t=>t.message})};return n.useEffect(()=>{T(),$()},[]),n.useEffect(()=>{s.category_id&&s.sport&&M()},[s]),e.jsxs("form",{className:"relative grid grid-cols-12 gap-4",children:[e.jsx(D,{label:"Titulo",isRequired:r,placeholder:"Títilo de la publicación",className:"col-span-4",variant:"underlined",onChange:a=>h("title",a.target.value.toLocaleLowerCase())}),e.jsx(D,{label:"Fecha",type:"date",isRequired:r,placeholder:"Fecha del encuentro",className:"col-span-4",variant:"underlined",onChange:a=>h("date",I(a.target.value).format("YYYY-MM-DD"))}),e.jsx(j,{label:"Sede",className:"col-span-4",variant:"underlined",isRequired:r,onChange:a=>h("location",a.target.value),children:c.map(a=>e.jsx(g,{value:a._id,children:a.name},a._id))}),e.jsxs(j,{label:"Deporte",className:"col-span-4",variant:"underlined",isRequired:r,onChange:a=>h("sport",a.target.value),children:[e.jsx(g,{value:"F7",children:"Futbol"},"F7"),e.jsx(g,{value:"HOCKEY",children:"Hockey"},"HOCKEY")]}),e.jsx(j,{label:"Categoría",className:"col-span-4",variant:"underlined",isRequired:r,onChange:a=>h("category_id",a.target.value),children:f.map(a=>e.jsx(g,{value:a._id,children:a.name},a._id))}),e.jsx(j,{label:"Equipos",className:"col-span-4",variant:"underlined",selectionMode:"multiple",isRequired:r,onChange:a=>h("list",a.target.value.split(",")),children:p.map(a=>e.jsx(g,{value:a._id,children:a.name},a._id))}),e.jsx("div",{className:"col-span-4"}),e.jsx("div",{className:"col-span-12 flex justify-end",children:e.jsx(x,{className:"col-span-12 font-semibold uppercase ms-auto bg-primary/60 hover:bg-primary",type:"submit",radius:"sm",isDisabled:F,onClick:a=>r?R(a):z(a),children:r?"Crear":"Editar"})})]})},ae=()=>{const{isOpen:l,onOpen:r,onOpenChange:o}=v();return e.jsxs(e.Fragment,{children:[e.jsx(x,{onPress:r,variant:"faded",color:"default",className:"mb-3",radius:"sm",children:"Nueva Pulicación"}),e.jsx(N,{isOpen:l,onOpenChange:o,size:"5xl",backdrop:"blur",className:"border dark text-foreground border-default-400",children:e.jsx(w,{children:c=>e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"flex items-start gap-1",children:"Crear nueva publicación"}),e.jsx(k,{className:"pb-5",children:e.jsx(P,{onClose:c,required:!0})})]})})})]})},se=ae,te=({id:l,title:r})=>{const{setRefresh:o}=C(),{isOpen:c,onOpen:d,onOpenChange:f}=v(),u=async p=>{_.promise(async()=>{try{if((await fetch(`https://apdcc.com.ar/api/publications/${l}`,{method:"DELETE",credentials:"include"})).ok)return o(),"¡Jugador/a eliminado/a con éxito! 😄";throw new Error("Oops, algo salió mal 😕")}catch(i){throw new Error("Error al procesar la solicitud: "+i.message)}finally{p()}},{loading:"Loading...",success:i=>i,error:i=>i.message})};return e.jsxs(e.Fragment,{children:[e.jsx(x,{isIconOnly:!0,onPress:d,color:"danger",size:"sm",className:"transition-all bg-danger/40 hover:bg-danger duration-350",children:e.jsx(J,{size:18})}),e.jsx(N,{size:"xl",isOpen:c,onOpenChange:f,className:"border dark text-foreground border-default-400",children:e.jsx(w,{children:p=>e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Warning"}),e.jsx(k,{children:e.jsxs("p",{children:["Esta seguro que desea borrar la publicación:",e.jsx("span",{className:"ml-2 font-semibold",children:r})]})}),e.jsx(B,{children:e.jsx(x,{color:"primary",variant:"solid",radius:"sm",className:"font-semibold uppercase rounded-md bg-danger/50 hover:bg-danger",onPress:()=>u(p),children:"Eliminar"})})]})})})]})},re=te,oe=({id:l})=>{const{isOpen:r,onOpen:o,onOpenChange:c}=v();return e.jsxs(e.Fragment,{children:[e.jsx(x,{isIconOnly:!0,onPress:o,color:"default",size:"sm",className:"bg-default/50 text-default-400 hover:text-white",children:e.jsx(U,{size:18})}),e.jsx(N,{isOpen:r,onOpenChange:c,className:"border dark text-foreground border-default-400",size:"5xl",children:e.jsx(w,{children:d=>e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Advertencia"}),e.jsxs(k,{className:"pb-5",children:[e.jsx("div",{children:"Esta acción es permanente y no se puede deshacer."}),e.jsx(P,{onClose:d,required:!1,id:l})]})]})})})]})},ne=oe,le=[{label:"Titulo",key:"title"},{label:"Sede",key:"location"},{label:"Deporte",key:"sport"},{label:"Categoria",key:"category_id"},{label:"Acciones",key:"actions"}];function ke(){const{isHiddenTopBar:l,refresh:r}=C(),[o,c]=n.useState([]),[d,f]=n.useState(1),[u,p]=n.useState(!0),i=async()=>{const s=await H(d);c(s.response),p(!1)};return n.useEffect(()=>{i()},[d,r]),e.jsxs("section",{className:`${l?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16  lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:[e.jsx("div",{className:"flex flex-wrap items-start justify-between w-full gap-4 pb-4 ",children:e.jsx(se,{})}),e.jsxs(V,{"aria-label":"Publications Table",bottomContent:o.page>0?e.jsx("div",{className:`${o.docs?"opacity-100":"opacity-0"} flex items-center justify-center w-full gap-4`,children:e.jsx(Z,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:o.page,total:o.totalPages,onChange:s=>{p(!0),f(s)}})}):null,children:[e.jsx(W,{columns:le,children:s=>e.jsx(G,{className:"uppercase",children:s.label},s.key)}),e.jsx(K,{emptyContent:u?" ":o.docs.length===0?"No se encontraron publicaiones":"",items:u?[]:o.docs,isLoading:u,loadingContent:e.jsx(q,{className:"mt-12",label:"Loading..."}),children:s=>e.jsx(Q,{children:m=>e.jsx(X,{className:"capitalize",children:m==="location"?e.jsx("p",{children:s.location.name}):m==="category_id"?e.jsx("p",{children:s.category_id.name}):m==="actions"?e.jsxs("div",{className:"flex gap-2",children:[e.jsx(re,{id:s._id,title:s.title}),e.jsx(ne,{id:s._id})]}):ee(s,m)})},s._id)})]})]})}export{ke as default};
