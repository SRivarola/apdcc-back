import{r as l,j as e,a0 as de,f as se,u as ce,b as Z,m as ue,a as me,s as I,A as fe,p as xe,a1 as pe}from"./index-vz6hTU99.js";import{S as R,F as k}from"./SectionContainer-38BmdjVL.js";import{h as ge}from"./moment-WSJ9un1t.js";import{b as H,s as _e}from"./ballIcon-EIqCvGZP.js";import{P as he,m as je}from"./pen-square-xFHFBFft.js";import{m as ye}from"./chunk-3S23ARPO-tQT5EPGf.js";import{m as ve}from"./chunk-EPDLEVDR-4AwwNosQ.js";import{i as v}from"./chunk-TC4QW7OA-GsVwBcjf.js";import{t as ee}from"./chunk-K3TANQWH-OVO_a1ZE.js";import{s as b,l as N}from"./chunk-ZFWMN6TD-aaEwT3fZ.js";import{c as S}from"./chunk-AMSULWPV-wS1TgwMM.js";import"./chunk-YRZGWF2W-eCFv_EBG.js";import"./chunk-7F3ZLNJ6-TtLaDn5p.js";import"./import-HCUA_NR3.js";import"./import-VOzEaUhZ.js";import"./chunk-M3MASYO7-imwZYqc9.js";function be({match:t}){const[a,c]=l.useState([]),[m,i]=l.useState(!0);return l.useEffect(()=>{t&&(async(f,x)=>{const u=await de(f,x);if(u.ok){const{response:d}=await u.json();c([...d[0].red_cards,...d[1].red_cards])}i(!1)})(t.tournament_id._id,t._id)},[t]),e.jsxs("div",{className:"flex justify-center gap-10 p-5 px-20 mx-auto mt-16",children:[e.jsx(R,{title:"JUEGO LIMPIO",isFetching:m,targets:!0,children:e.jsx(k,{items:[t.fair_play],tournament:!1})}),e.jsx(R,{title:"MEJOR JUGADOR",isFetching:m,targets:!0,children:e.jsx(k,{items:[t.best_player],tournament:!1})}),e.jsx(R,{title:"tarjetas rojas 🟥",isFetching:m,targets:!0,children:e.jsx(k,{items:a,tournament:!1})})]})}function Ne({infoHeader:t,match:a}){return e.jsxs("div",{className:"mb-6 text-center lg:px-3",children:[e.jsx("h1",{className:"text-xl font-bold uppercase lg:text-3xl",children:t==null?void 0:t.name}),e.jsx("span",{className:"font-semibold uppercase text-default-400",children:`${ge(a.date).format("DD-MM-YYYY")} - ${t==null?void 0:t.time}`})]})}const we=function({match:a}){var f,x;const[c,m]=l.useState(),[i,_]=l.useState();return l.useEffect(()=>{async function u(){try{const d=await fetch(`http://localhost:8080/api/targets/tournament/${a.tournament_id._id}/match/${a._id}`);if(d.ok){const{response:j}=await d.json();m(j.filter(y=>y.team_id._id===a.local.team_id._id)[0]),_(j.filter(y=>y.team_id._id===a.visit.team_id._id)[0])}}catch(d){console.log(d)}}a&&u()},[a]),e.jsxs("div",{className:"flex items-start justify-between max-w-6xl gap-5 pt-5 mx-auto lg:mt-10",children:[e.jsxs("div",{className:"flex flex-col items-center justify-end w-full",children:[e.jsx("p",{className:"text-default-400",children:"Local"}),e.jsx("h2",{className:"text-lg font-bold uppercase lg:text-2xl",children:(f=a==null?void 0:a.local)==null?void 0:f.team_id.name}),e.jsx("p",{className:`${(a==null?void 0:a.res_local)>(a==null?void 0:a.res_visit)?"text-success shadow-green-600 rounded-md shadow":"rounded-md shadow shadow-white"} p-5 m-5  text-7xl text-extrabold`,children:a==null?void 0:a.res_local}),e.jsx("p",{className:`${c!=null&&c.message?"":"text-default-400"} p-5`,children:(c==null?void 0:c.message)||"No hay mensaje"})]}),e.jsxs("div",{className:"flex flex-col items-center justify-end w-full",children:[e.jsx("p",{className:"text-default-400",children:"Visitante"}),e.jsx("h2",{className:"text-lg font-bold uppercase lg:text-2xl",children:(x=a==null?void 0:a.visit)==null?void 0:x.team_id.name}),e.jsx("p",{className:`${(a==null?void 0:a.res_visit)>(a==null?void 0:a.res_local)?"text-success shadow-green-600 rounded-md shadow":"rounded-md shadow shadow-white"} p-5 m-5  text-7xl text-extrabold`,children:a==null?void 0:a.res_visit}),e.jsx("p",{className:`${i!=null&&i.message?"":"text-default-400"} p-5`,children:(i==null?void 0:i.message)||"No hay mensaje"})]})]})},Ce=we,Pe=Ce;function Se({match:t,tournamentId:a}){const{setRefresh:c}=se(),{isOpen:m,onOpen:i,onOpenChange:_}=ce(),[f,x]=l.useState(!1),[u,d]=l.useState(!1),[j,y]=l.useState(!1),[$,A]=l.useState(!1),[M,z]=l.useState(""),[T,D]=l.useState(""),[V,ae]=l.useState({res_local:0,res_visit:0}),[p,J]=l.useState({red_card:0,yellow_card:0,message:""}),[g,O]=l.useState({red_card:0,yellow_card:0,message:""}),[G,te]=l.useState(null),[L,le]=l.useState([]),[B,re]=l.useState([]),[w,ne]=l.useState([]),[C,ie]=l.useState([]),[W,Y]=l.useState(null);l.useEffect(()=>{t&&(async()=>{try{const o=await fetch(`http://localhost:8080/api/targets/tournament/${a}/match/${t._id}`);if(!o.ok){console.log("Algo salio mal en el fetch");return}const{response:n}=await o.json(),h=n.find(s=>s.team_id._id===t.local.team_id._id),P=n.find(s=>s.team_id._id===t.visit.team_id._id);te({local:h._id,visit:P._id})}catch(o){console.error(o)}})()},[a,t._id]);const q=async(r,o)=>{try{const n=await fetch(`http://localhost:8080/api/players/all/?team=${r}`,{method:"GET",credentials:"include"});if(n.ok){const{response:h}=await n.json();o?ne(h):ie(h)}}catch(n){throw new Error(n)}};l.useEffect(()=>{q(t.local.team_id._id,!0)},[p]),l.useEffect(()=>{q(t.visit.team_id._id,!1)},[g]),l.useEffect(()=>{x(!1),d(!1),y(!1),A(!1),z(null),D(null)},[_]);const U=r=>{ae({...V,[r.target.name]:Number(r.target.value)||0})},E=r=>{r.target.name==="message"?J({...p,message:r.target.value}):J({...p,[r.target.name]:Number(r.target.value)||0})},F=r=>{r.target.name==="message"?O({...g,message:r.target.value}):O({...g,[r.target.name]:Number(r.target.value)||0})},K=(r,o)=>{const n=r.target.value;if(o){le(n.split(","));return}else{re(n.split(","));return}},oe=async r=>{const o={res_local:V.res_local,res_visit:V.res_visit,best_player:M,fair_play:T,targetLocal:p,targetVisit:g,targetLocal_id:G.local,targetVisit_id:G.visit,redCards:{localPlayersWithRedCards:L,visitPlayersWithRedCards:B}};if(p.red_card!==L.length||g.red_card!==B.length){Y("*¡Formulario completado incorrectamente, inténtelo nuevamente!");return}Y(null),fe.promise(async()=>{try{if((await fetch(`http://localhost:8080/api/matches/results/${t._id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)return c(),"Datos cargados con éxito 😀"}catch(n){return console.log(n),"Algo salio mal 😮‍💨"}finally{r()}},{loading:"Loading...",success:n=>n,error:n=>n.message})},Q=r=>{const{value:o}=r.target;z(o)},X=r=>{const{name:o,value:n}=r.target;D(n)};return e.jsxs(e.Fragment,{children:[e.jsx(Z,{onPress:i,color:"primary",size:"sm",endContent:e.jsx(he,{size:16}),className:"top-0 right-0 flex font-semibold hover:text-white ms-auto",children:"Editar"}),e.jsx(ue,{isOpen:m,onOpenChange:_,size:"3xl",className:"w-full border dark text-foreground border-default-400",children:e.jsx(me,{children:r=>{var o,n,h,P;return e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"flex flex-col gap-1",children:"Carga de datos"}),e.jsx(ve,{children:e.jsxs("div",{className:"grid grid-cols-12 gap-10",children:[e.jsxs("div",{className:"block w-full col-span-6",children:[e.jsx("h2",{className:"text-xl uppercase",children:(n=(o=t.local)==null?void 0:o.team_id)==null?void 0:n.name}),e.jsx(v,{size:"sm",variant:"underlined",type:"number",min:"0",step:"1",placeholder:"Goles anotados",startContent:H,defaultValue:0,name:"res_local",onChange:s=>U(s)}),e.jsx(v,{size:"sm",variant:"underlined",type:"number",min:"0",step:"1",placeholder:"Tarjetas Amarillas",startContent:e.jsx("span",{children:"🟨"}),defaultValue:0,name:"yellow_card",onChange:s=>E(s)}),e.jsx(v,{size:"sm",type:"number",variant:"underlined",min:"0",step:"1",placeholder:"Tarjetas Rojas",startContent:e.jsx("span",{children:"🟥"}),defaultValue:0,name:"red_card",onChange:s=>E(s)}),e.jsx(ee,{placeholder:"Mensaje",className:"pt-5 ",name:"message",onChange:s=>E(s)}),p.red_card>0&&w.length?e.jsx(b,{label:"Asignar tarjeta roja",isRequired:!0,className:"col-span-4",variant:"underlined",selectionMode:p.red_card>1?"multiple":"single",selectedKeys:L,onChange:s=>K(s,!0),children:w.map(s=>e.jsx(N,{value:s._id,children:`${s.first_name+" "+s.last_name}`},`${s._id}`))}):p.red_card>0?e.jsx("div",{className:"flex justify-center w-full mt-3",children:e.jsx(I,{})}):null,e.jsx(S,{isSelected:f,onValueChange:x,className:"mt-3",isDisabled:j,children:"Mejor Jugador"}),f&&e.jsx(b,{"aria-label":"Best Local Player",placeholder:"Selecciona al mejor jugador",variant:"underlined",name:"best_player",value:M,onChange:Q,children:w.map(s=>e.jsx(N,{value:s._id,children:`${s.first_name+" "+s.last_name}`},`${s._id}`))}),e.jsxs("div",{children:[e.jsx(S,{isSelected:u,onValueChange:d,className:"mt-3",isDisabled:$,children:"Juego Limpio"}),u&&e.jsx(b,{"aria-label":"Fair Local Player",placeholder:"Selecciona juego limpio",variant:"underlined",name:"fair_play",value:T,onChange:X,children:w.map(s=>e.jsx(N,{value:s._id,children:`${s.first_name+" "+s.last_name}`},`${s._id}`))})]})]}),e.jsxs("div",{className:"block w-full col-span-6",children:[e.jsx("h2",{className:"text-xl uppercase",children:(P=(h=t.visit)==null?void 0:h.team_id)==null?void 0:P.name}),e.jsx(v,{size:"sm",type:"number",variant:"underlined",min:"0",step:"1",placeholder:"Goles anotados",startContent:H,defaultValue:0,name:"res_visit",onChange:s=>U(s)}),e.jsx(v,{size:"sm",variant:"underlined",type:"number",min:"0",step:"1",placeholder:"Tarjetas Amarillas",startContent:e.jsx("span",{children:"🟨"}),defaultValue:0,name:"yellow_card",onChange:s=>F(s)}),e.jsx(v,{size:"sm",type:"number",variant:"underlined",min:"0",step:"1",placeholder:"Tarjetas Rojas",startContent:e.jsx("span",{children:"🟥"}),defaultValue:0,name:"red_card",onChange:s=>F(s)}),e.jsx(ee,{placeholder:"Mensaje",className:"pt-5 ",name:"message",onChange:s=>F(s)}),g.red_card>0&&C.length?e.jsx(b,{label:"Asignar tarjeta roja",isRequired:!0,className:"col-span-4",variant:"underlined",selectedKeys:B,selectionMode:g.red_card>1?"multiple":"single",onChange:s=>K(s,!1),children:C.map(s=>e.jsx(N,{value:s._id,children:`${s.first_name+" "+s.last_name}`},`${s._id}`))}):g.red_card>0?e.jsx("div",{className:"flex justify-center w-full mt-3",children:e.jsx(I,{})}):null,e.jsx(S,{isSelected:j,onValueChange:y,className:"mt-3",isDisabled:f,children:"Mejor Jugador"}),j&&e.jsx(b,{"aria-label":"Best Visit Player",placeholder:"Selecciona al mejor jugador",variant:"underlined",name:"best_player",value:M,onChange:Q,children:C.map(s=>e.jsx(N,{value:s._id,children:`${s.first_name+" "+s.last_name}`},`${s._id}`))}),e.jsxs("div",{children:[e.jsx(S,{isSelected:$,onValueChange:A,className:"mt-3",isDisabled:u,children:"Juego Limpio"}),$&&e.jsx(b,{"aria-label":"Fair Visit Player",placeholder:"Selecciona juego limpio",variant:"underlined",name:"fair_play",value:T,onChange:X,children:C.map(s=>e.jsx(N,{value:s._id,children:`${s.first_name+" "+s.last_name}`},`${s._id}`))})]})]})]})}),e.jsxs(je,{className:"flex flex-col",children:[W?e.jsx("p",{className:"text-sm font-semibold text-center text-danger",children:W}):null,e.jsx(Z,{className:"z-0 order-last w-full font-semibold uppercase bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",startContent:_e,onPress:()=>{oe(r)},children:"Guardar"})]})]})}})})]})}function Ge(){const{id:t}=xe(),{isHiddenTopBar:a}=se(),[c,m]=l.useState(),[i,_]=l.useState(null);return l.useEffect(()=>{t&&(async x=>{const u=await pe(x);if(u.ok){const{response:d}=await u.json();_(d),m(d.tournament_id)}})(t)},[t]),i?e.jsxs("section",{className:`${a?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16  lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:[e.jsx(Se,{match:i,tournamentId:i.tournament_id._id}),e.jsx(Ne,{infoHeader:c,match:i}),e.jsx(Pe,{match:i}),e.jsx(be,{match:i})]}):e.jsx("div",{className:`${a?"pt-12":"pt-36"} absolute top-0 left-0 flex justify-center items-center w-full pl-5 lg:pl-[200px] pb-16  lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:e.jsx(I,{})})}export{Ge as default};
