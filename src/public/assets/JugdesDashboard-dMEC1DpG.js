import{u as T,j as e,m as L,a as z,i as Q,s as C,E as X,r as c,f as Z,b as I,A as ee}from"./index-WqbPWE0E.js";import{h as q}from"./moment-WSJ9un1t.js";import{I as ae}from"./image-uekkU0C8.js";import{m as V}from"./chunk-3S23ARPO-eiL4WC3X.js";import{m as D}from"./chunk-EPDLEVDR-54dcRee3.js";import{t as se,a as te,b as le,c as re,d as ne,e as oe}from"./chunk-YRZGWF2W-hcMjxO4J.js";import{g as ie}from"./chunk-KARN4QIT-0lg9pr17.js";import{c as Y}from"./chunk-OFH6WYRQ-oWe43lFJ.js";import{i as N}from"./chunk-TC4QW7OA-v-iVWaFn.js";import{t as F}from"./chunk-K3TANQWH-pElV0bqR.js";import{s as G,l as W}from"./chunk-ZFWMN6TD-2mDsgrVL.js";import{m as ce}from"./chunk-QY5NICTW-_zE6iGR2.js";import"./chunk-AMSULWPV-a7khhzyU.js";import"./import-hIBVkbdo.js";import"./chunk-7F3ZLNJ6-12qWG1A4.js";import"./chunk-M3MASYO7-kWQ4oELG.js";import"./import-yG13OaeA.js";function de({dni:n,dniUrl:s}){const{isOpen:p,onOpen:t,onOpenChange:o}=T();return e.jsxs(e.Fragment,{children:[e.jsxs("p",{onClick:t,className:"flex gap-1 cursor-pointer hover:text-blue-500",children:[e.jsx(ae,{size:18}),n]}),e.jsx(L,{scrollBehavior:"inside",isOpen:p,onOpenChange:o,className:"border dark text-foreground border-default-400 w-fit",children:e.jsx(z,{children:()=>e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"flex flex-col gap-1"}),e.jsx(D,{className:"flex justify-center",children:e.jsx(Q,{src:s,alt:"imagen dni",className:"mx-auto"})})]})})})]})}const ue=[{label:"nombre",key:"customName"},{label:"DNI",key:"dni"},{label:"edad",key:"age"}],me=function({players:s,name:p}){return e.jsxs("section",{className:"w-full pb-16 mb-10",children:[e.jsx("div",{children:e.jsxs("p",{className:"pb-4 text-center",children:["Jugadores de ",e.jsx("strong",{children:p})]})}),e.jsxs(se,{"aria-label":"Players Table",children:[e.jsx(te,{columns:ue,children:t=>e.jsx(le,{className:"uppercase",children:t.label},t.key)}),e.jsx(re,{emptyContent:s.length===0?"No se encontraron jugadores/as":"",items:s,loadingContent:e.jsx(C,{className:"mt-12",label:"Loading..."}),children:t=>e.jsx(ne,{children:o=>e.jsx(oe,{className:"capitalize",children:o==="customName"?e.jsx(X,{avatarProps:{radius:"lg",src:t.avatar.url},name:`${t.first_name} ${t.last_name}`,children:`${t.first_name} ${t.last_name}`}):o==="dni"?e.jsx(de,{dni:t.dni,dniUrl:t.dni_photo.url}):ie(t,o)})},t._id)})]})]})},B=me;function pe({localName:n,localId:s,visitName:p,visitId:t,isOpen:o,onOpenChange:h}){const[j,f]=c.useState([]),[_,d]=c.useState([]);return c.useEffect(()=>{const b=localStorage.getItem("apdcc_token");async function u(){try{const i=await fetch(`https://apdcc-back-production.up.railway.app/api/players/all/?team=${s}`,{method:"GET",headers:{token:b}});if(i.ok){const{response:g}=await i.json();f(g)}}catch(i){console.log(i)}}async function v(){try{const i=await fetch(`https://apdcc-back-production.up.railway.app/api/players/all/?team=${t}`,{method:"GET",headers:{token:b}});if(i.ok){const{response:g}=await i.json();d(g)}}catch(i){console.log(i)}}async function y(){try{await Promise.all([u(),v()])}catch(i){console.log(i)}}y()},[s,t,h]),e.jsx(e.Fragment,{children:e.jsx(L,{scrollBehavior:"inside",size:"full",isOpen:o,onOpenChange:h,className:"border dark text-foreground border-default-400",children:e.jsx(z,{children:()=>e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"flex flex-col gap-1"}),e.jsx(D,{children:e.jsxs("div",{className:"flex flex-wrap justify-between w-full gap-10",children:[e.jsx(B,{players:j,name:n}),e.jsx(B,{players:_,name:p})]})})]})})})})}const fe=function({match:s}){var h,j,f,_,d,b,u,v,y,i;const{isOpen:p,onOpen:t,onOpenChange:o}=T();return e.jsx(e.Fragment,{children:e.jsxs("div",{className:"grid items-center grid-cols-3 col-span-2 gap-2 lg:gap-5 px-5 py-3 text-center transition-transform duration-150 ease-linear border rounded-lg  md:col-span-1 border-default-200 bg-gradient-to-br from-white to-default-200 dark:from-default-50 dark:to-black  relative w-full cursor-pointer",onClick:t,children:[e.jsx("p",{className:"col-start-1 text-sm text-default-400",children:"Local"}),e.jsx("p",{className:"col-start-2 mb-auto text-sm lg:text-base",children:q(s.date).add(1,"days").format("DD-MM-YYYY")}),e.jsxs("div",{className:"flex flex-col items-center col-start-1 row-start-2 min-h-24",children:[e.jsx("p",{className:"text-xs font-semibold uppercase lg:text-sm lg:font-bold",children:((j=(h=s.local)==null?void 0:h.team_id)==null?void 0:j.name)||e.jsx(Y,{variant:"flat",color:"warning",children:"fecha libre"})}),(f=s==null?void 0:s.res_local)!=null&&f.toString()?e.jsx("span",{className:"text-xl font-bold lg:text-2xl",children:s.res_local}):null]}),e.jsx("div",{className:"flex flex-col items-center justify-between col-start-2 row-start-2 gap-3 my-auto",children:e.jsx("span",{className:" text-warning",children:"vs"})}),e.jsx("p",{className:"col-start-3 text-sm text-default-400",children:"Visitante"}),e.jsxs("div",{className:"relative flex flex-col items-center col-start-3 row-start-2",children:[e.jsx("p",{className:"text-xs font-bold uppercase lg:text-sm",children:((d=(_=s.visit)==null?void 0:_.team_id)==null?void 0:d.name)||e.jsx(Y,{variant:"flat",color:"warning",children:"fecha libre"})}),(b=s==null?void 0:s.res_visit)!=null&&b.toString()?e.jsx("span",{className:"text-xl font-bold lg:text-2xl",children:s.res_visit}):null]}),e.jsx(pe,{isOpen:p,onOpenChange:o,localName:(v=(u=s.local)==null?void 0:u.team_id)==null?void 0:v.name,localId:s.local.team_id._id,visitName:(i=(y=s.visit)==null?void 0:y.team_id)==null?void 0:i.name,visitId:s.visit.team_id._id})]})})},xe=fe,he=xe,ge=e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"icon icon-tabler icon-tabler-scoreboard",width:"24",height:"24",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M3 5m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z"}),e.jsx("path",{d:"M12 5v2"}),e.jsx("path",{d:"M12 10v1"}),e.jsx("path",{d:"M12 14v1"}),e.jsx("path",{d:"M12 18v1"}),e.jsx("path",{d:"M7 3v2"}),e.jsx("path",{d:"M17 3v2"}),e.jsx("path",{d:"M15 10.5v3a1.5 1.5 0 0 0 3 0v-3a1.5 1.5 0 0 0 -3 0z"}),e.jsx("path",{d:"M6 9h1.5a1.5 1.5 0 0 1 0 3h-.5h.5a1.5 1.5 0 0 1 0 3h-1.5"})]}),J=e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"flex-shrink-0 pointer-events-none icon icon-tabler icon-tabler-ball-football text-default-400",width:"22",height:"22",viewBox:"0 0 24 24",strokeWidth:"2",stroke:"currentColor",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",children:[e.jsx("path",{stroke:"none",d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M12 12m-9 0a9 9 0 1 0 18 0a9 9 0 1 0 -18 0"}),e.jsx("path",{d:"M12 7l4.76 3.45l-1.76 5.55h-6l-1.76 -5.55z"}),e.jsx("path",{d:"M12 7v-4m3 13l2.5 3m-.74 -8.55l3.74 -1.45m-11.44 7.05l-2.56 2.95m.74 -8.55l-3.74 -1.45"})]});function je({match:n,tournamentId:s}){const p=localStorage.getItem("apdcc_token"),{isOpen:t,onOpen:o,onOpenChange:h}=T(),{setRefresh:j}=Z(),[f,_]=c.useState({res_local:0,res_visit:0}),[d,b]=c.useState({red_card:0,yellow_card:0,message:""}),[u,v]=c.useState({red_card:0,yellow_card:0,message:""}),[y,i]=c.useState(null),[g,M]=c.useState([]),[k,P]=c.useState([]),[R,H]=c.useState([]),[E,U]=c.useState([]);c.useEffect(()=>{n&&(async()=>{try{const m=await fetch(`https://apdcc-back-production.up.railway.app/api/targets/tournament/${s}/match/${n._id}`);if(!m.ok){console.log("Algo salio mal en el fetch");return}const{response:l}=await m.json(),x=l.find(a=>a.team_id._id===n.local.team_id._id),w=l.find(a=>a.team_id._id===n.visit.team_id._id);i({local:x._id,visit:w._id})}catch(m){console.error(m)}})()},[s,n._id]),c.useEffect(()=>{const r=async(m,l)=>{try{const x=await fetch(`https://apdcc-back-production.up.railway.app/api/players/all/?team=${m}`,{method:"GET",credentials:"include",headers:{token:p}});if(console.log("response",x),x.ok){const{response:w}=await x.json();l?H(w):U(w)}}catch(x){throw new Error(x)}};d.red_card>0&&r(n.local.team_id._id,!0),u.red_card>0&&r(n.visit.team_id._id,!1)},[d,u]);const O=r=>{_({...f,[r.target.name]:Number(r.target.value)||0})},$=r=>{r.target.name==="message"?b({...d,message:r.target.value}):b({...d,[r.target.name]:Number(r.target.value)||0})},S=r=>{r.target.name==="message"?v({...u,message:r.target.value}):v({...u,[r.target.name]:Number(r.target.value)||0})},A=(r,m)=>{const l=r.target.value;if(m){if(g.includes(l)){M(l.split(","));return}if(g.length<d.red_card){l==""?M([]):M(l.split(","));return}}else{if(k.includes(l)){P(l.split(","));return}if(k.length<u.red_card){l==""?P([]):P(l.split(","));return}}},K=async r=>{const m=localStorage.getItem("apdcc_token");ee.promise(async()=>{try{if((await fetch(`https://apdcc-back-production.up.railway.app/api/matches/results/${n._id}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",token:m},body:JSON.stringify({results:f,targetLocal:d,targetVisit:u,targetLocal_id:y.local,targetVisit_id:y.visit,redCards:{localPlayersWithRedCards:g,visitPlayersWithRedCards:k}})})).ok)return j(),"Datos cargados con éxito 😀"}catch(l){return console.log(l),"Algo salio mal 😮‍💨"}finally{r()}},{loading:"Loading...",success:l=>l,error:l=>l.message})};return e.jsxs(e.Fragment,{children:[e.jsx(I,{onPress:o,children:"Cargar resultados"}),e.jsx(L,{isOpen:t,onOpenChange:h,size:"3xl",className:"w-full border dark text-foreground border-default-400",children:e.jsx(z,{children:r=>{var m,l,x,w;return e.jsxs(e.Fragment,{children:[e.jsx(V,{className:"flex flex-col gap-1",children:"Carga de datos"}),e.jsx(D,{children:e.jsxs("div",{className:"grid items-center grid-cols-12 gap-10",children:[e.jsxs("div",{className:"block w-full col-span-6",children:[e.jsx("h2",{className:"text-base uppercase lg:text-xl",children:(l=(m=n.local)==null?void 0:m.team_id)==null?void 0:l.name}),e.jsx(N,{size:"sm",variant:"underlined",type:"number",min:"0",step:"1",placeholder:"Goles anotados",startContent:J,defaultValue:0,name:"res_local",onChange:a=>O(a)}),e.jsx(N,{size:"sm",variant:"underlined",type:"number",min:"0",step:"1",placeholder:"Tarjetas Amarillas",startContent:e.jsx("span",{children:"🟨"}),defaultValue:0,name:"yellow_card",onChange:a=>$(a)}),e.jsx(N,{size:"sm",type:"number",variant:"underlined",min:"0",step:"1",placeholder:"Tarjetas Rojas",startContent:e.jsx("span",{children:"🟥"}),defaultValue:0,name:"red_card",onChange:a=>$(a)}),e.jsx(F,{placeholder:"Mensaje",className:"pt-5 ",name:"message",onChange:a=>$(a)}),d.red_card>0&&R.length?e.jsx(G,{label:"Asignar tarjeta roja",isRequired:!0,className:"col-span-4",variant:"underlined",selectionMode:d.red_card>1?"multiple":"single",isDisabled:d.red_card===g.length,selectedKeys:g,onChange:a=>A(a,!0),children:R.map(a=>e.jsx(W,{value:a._id,children:`${a.first_name+" "+a.last_name}`},`${a._id}`))}):d.red_card>0?e.jsx("div",{className:"flex justify-center w-full mt-3",children:e.jsx(C,{})}):null]}),e.jsxs("div",{className:"block w-full col-span-6",children:[e.jsx("h2",{className:"text-base uppercase lg:text-xl",children:(w=(x=n.visit)==null?void 0:x.team_id)==null?void 0:w.name}),e.jsx(N,{size:"sm",type:"number",variant:"underlined",min:"0",step:"1",placeholder:"Goles anotados",startContent:J,defaultValue:0,name:"res_visit",onChange:a=>O(a)}),e.jsx(N,{size:"sm",variant:"underlined",type:"number",min:"0",step:"1",placeholder:"Tarjetas Amarillas",startContent:e.jsx("span",{children:"🟨"}),defaultValue:0,name:"yellow_card",onChange:a=>S(a)}),e.jsx(N,{size:"sm",type:"number",variant:"underlined",min:"0",step:"1",placeholder:"Tarjetas Rojas",startContent:e.jsx("span",{children:"🟥"}),defaultValue:0,name:"red_card",onChange:a=>S(a)}),e.jsx(F,{placeholder:"Mensaje",className:"pt-5 ",name:"message",onChange:a=>S(a)}),u.red_card>0&&E.length?e.jsx(G,{label:"Asignar tarjeta roja",isRequired:!0,className:"col-span-4",variant:"underlined",selectedKeys:k,isDisabled:u.red_card===k.length,selectionMode:u.red_card>1?"multiple":"single",onChange:a=>A(a,!1),children:E.map(a=>e.jsx(W,{value:a._id,children:`${a.first_name+" "+a.last_name}`},`${a._id}`))}):u.red_card>0?e.jsx("div",{className:"flex justify-center w-full mt-3",children:e.jsx(C,{})}):null]})]})}),e.jsx(ce,{children:e.jsx(I,{className:"z-0 order-last w-full font-semibold uppercase bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",startContent:ge,onPress:()=>{K(r)},children:"Guardar"})})]})}})})]})}function Re(){const[n,s]=c.useState(!0),[p,t]=c.useState([]);return c.useEffect(()=>{const h=q(new Date).format("YYYY-MM-DD");async function j(){try{const f=await fetch(`https://apdcc-back-production.up.railway.app/api/matches/?date=${h}`);if(f.ok){const{response:_}=await f.json();t(_)}}catch(f){console.log(f)}finally{s(!1)}}j()},[]),n?e.jsxs("div",{className:"absolute top-0 left-0 flex flex-col items-center justify-center w-full h-full gap-3",children:[e.jsx(C,{}),"...loading"]}):!p.length&&!n?e.jsx("div",{className:"absolute top-0 left-0 w-full h-screen pb-16 pl-5 pr-5 overflow-y-scroll bg-black pt-36 lg:pt-20",children:"No hay partidos pendiente para la fecha actual."}):e.jsx("section",{className:"absolute top-0 left-0 w-full h-screen pb-16 pl-5 pr-5 overflow-y-scroll bg-black pt-36 lg:pt-20",children:e.jsx("div",{className:"max-w-5xl mx-auto space-y-10",children:p.map(o=>e.jsxs("div",{className:"space-y-2",children:[e.jsx(je,{match:o,tournamentId:o.tournament_id}),e.jsx(he,{match:o})]},o._id))})})}export{Re as default};
