import{r as l,K as _,j as e,b as x,O as F,S as $,ad as R,A as C,a as v,m as w,c as N,s as q,ao as L}from"./index-uGAMUMvn.js";import{i as M}from"./chunk-TC4QW7OA-gWeZRfJj.js";import{s as b,l as g}from"./chunk-ZFWMN6TD-q3RyK-W7.js";import{m as E}from"./chunk-3S23ARPO-iV4meqdY.js";import{m as k}from"./chunk-EPDLEVDR-Xw8sksat.js";import{T as z}from"./trash-2-E-y3BZN2.js";import{m as A}from"./chunk-QY5NICTW-C1KIj6vy.js";import{t as H,a as I,b as J,c as Y,d as B,e as K}from"./chunk-YRZGWF2W-ibqTm3ZV.js";import{p as V}from"./chunk-BIN3WWJN-Hyobe3RO.js";import{g as W}from"./chunk-KARN4QIT-6T1kQ05I.js";import"./import-BSb6SRGb.js";import"./import-9AtIfbcL.js";import"./chunk-M3MASYO7-YSrvo_oy.js";import"./chunk-7F3ZLNJ6-VI7Sl4st.js";import"./chunk-AMSULWPV-k0jmkM9R.js";import"./chunk-RFUEKIFS-kjMkjToG.js";const G=({onClose:i})=>{const[c,o]=l.useState([]),[d,m]=l.useState([]),[h,u]=l.useState([]),[t,n]=l.useState({title:"",location:"",sport:"",category_id:"",list:[]}),[s,p]=l.useState(!1),{setRefresh:S}=_(),D=async()=>{try{const a=await F();if(a.ok){const r=await a.json();o(r.response)}}catch(a){throw a}},O=async()=>{try{const a=await $();if(a.ok){const j=(await a.json()).response.filter(y=>y.name==="6-7"||y.name==="8-9");m(j)}}catch(a){throw a}},P=async()=>{try{const a=await R(`sport=${t.sport}&category_id=${t.category_id}`);if(a.ok){const r=await a.json();u(r.response)}}catch(a){throw a}},f=(a,r)=>{n(j=>({...j,[a]:r}))},T=async a=>{p(!0),a.preventDefault(),C.promise(async()=>{try{if((await fetch("https://apdcc.com.ar/api/publications/create",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)return S(),"¡Creación Exitosa! 😄";throw new Error("Oops, algo salió mal en el creación. 😕")}catch(r){console.log(r)}finally{p(!1),i()}},{loading:"Loading...",success:r=>r,error:r=>r.message})};return l.useEffect(()=>{D(),O()},[]),l.useEffect(()=>{t.category_id&&t.sport&&P()},[t]),e.jsxs("form",{className:"relative grid grid-cols-12 gap-4",children:[e.jsx(M,{label:"Titulo",isRequired:!0,placeholder:"Títilo de la publicación",className:"col-span-4",variant:"underlined",onChange:a=>f("title",a.target.value.toLocaleLowerCase())}),e.jsx(b,{label:"Sede",className:"col-span-4",variant:"underlined",isRequired:!0,onChange:a=>f("location",a.target.value),children:c.map(a=>e.jsx(g,{value:a._id,children:a.name},a._id))}),e.jsxs(b,{label:"Deporte",className:"col-span-4",variant:"underlined",isRequired:!0,onChange:a=>f("sport",a.target.value),children:[e.jsx(g,{value:"F7",children:"Futbol"},"F7"),e.jsx(g,{value:"HOCKEY",children:"Hockey"},"HOCKEY")]}),e.jsx(b,{label:"Categoría",className:"col-span-4",variant:"underlined",isRequired:!0,onChange:a=>f("category_id",a.target.value),children:d.map(a=>e.jsx(g,{value:a._id,children:a.name},a._id))}),e.jsx(b,{label:"Equipos",className:"col-span-4",variant:"underlined",selectionMode:"multiple",isRequired:!0,onChange:a=>f("list",a.target.value.split(",")),children:h.map(a=>e.jsx(g,{value:a._id,children:a.name},a._id))}),e.jsx("div",{className:"col-span-4"}),e.jsx("div",{className:"col-span-12 flex justify-end",children:e.jsx(x,{className:"col-span-12 font-semibold uppercase ms-auto bg-primary/60 hover:bg-primary",type:"submit",radius:"sm",isDisabled:s,onClick:a=>T(a),children:"Crear"})})]})},Q=()=>{const{isOpen:i,onOpen:c,onOpenChange:o}=v();return e.jsxs(e.Fragment,{children:[e.jsx(x,{onPress:c,variant:"faded",color:"default",className:"mb-3",radius:"sm",children:"Nueva Pulicación"}),e.jsx(w,{isOpen:i,onOpenChange:o,size:"5xl",backdrop:"blur",className:"border dark text-foreground border-default-400",children:e.jsx(N,{children:d=>e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"flex items-start gap-1",children:"Crear nueva publicación"}),e.jsx(k,{className:"pb-10",children:e.jsx(G,{onClose:d})})]})})})]})},U=Q,X=({id:i,title:c})=>{const{setRefresh:o}=_(),{isOpen:d,onOpen:m,onOpenChange:h}=v(),u=async t=>{C.promise(async()=>{try{if((await fetch(`https://apdcc.com.ar/api/publications/${i}`,{method:"DELETE",credentials:"include"})).ok)return o(),"¡Jugador/a eliminado/a con éxito! 😄";throw new Error("Oops, algo salió mal 😕")}catch(n){throw new Error("Error al procesar la solicitud: "+n.message)}finally{t()}},{loading:"Loading...",success:n=>n,error:n=>n.message})};return e.jsxs(e.Fragment,{children:[e.jsx(x,{isIconOnly:!0,onPress:m,color:"danger",size:"sm",className:"transition-all bg-danger/40 hover:bg-danger duration-350",children:e.jsx(z,{size:18})}),e.jsx(w,{size:"xl",isOpen:d,onOpenChange:h,className:"border dark text-foreground border-default-400",children:e.jsx(N,{children:t=>e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Warning"}),e.jsx(k,{children:e.jsxs("p",{children:["Esta seguro que desea borrar la publicación:",e.jsx("span",{className:"ml-2 font-semibold",children:c})]})}),e.jsx(A,{children:e.jsx(x,{color:"primary",variant:"solid",radius:"sm",className:"font-semibold uppercase rounded-md bg-danger/50 hover:bg-danger",onPress:()=>u(t),children:"Eliminar"})})]})})})]})},Z=X,ee=[{label:"Titulo",key:"title"},{label:"Sede",key:"location"},{label:"Deporte",key:"sport"},{label:"Categoria",key:"category_id"},{label:"Acciones",key:"actions"}];function be(){const{isHiddenTopBar:i,refresh:c}=_(),[o,d]=l.useState([]),[m,h]=l.useState(1),[u,t]=l.useState(!0),n=async()=>{const s=await L(m);d(s.response),t(!1)};return l.useEffect(()=>{n()},[m,c]),e.jsxs("section",{className:`${i?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16  lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:[e.jsx("div",{className:"flex flex-wrap items-start justify-between w-full gap-4 pb-4 ",children:e.jsx(U,{})}),e.jsxs(H,{"aria-label":"Publications Table",bottomContent:o.page>0?e.jsx("div",{className:`${o.docs?"opacity-100":"opacity-0"} flex items-center justify-center w-full gap-4`,children:e.jsx(V,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:o.page,total:o.totalPages,onChange:s=>{t(!0),h(s)}})}):null,children:[e.jsx(I,{columns:ee,children:s=>e.jsx(J,{className:"uppercase",children:s.label},s.key)}),e.jsx(Y,{emptyContent:u?" ":o.docs.length===0?"No se encontraron publicaiones":"",items:u?[]:o.docs,isLoading:u,loadingContent:e.jsx(q,{className:"mt-12",label:"Loading..."}),children:s=>e.jsx(B,{children:p=>e.jsx(K,{className:"capitalize",children:p==="location"?e.jsx("p",{children:s.location.name}):p==="category_id"?e.jsx("p",{children:s.category_id.name}):p==="actions"?e.jsx(Z,{id:s._id,title:s.title}):W(s,p)})},s._id)})]})]})}export{be as default};
