import{r as n,j as e,f as P,b as v,A as S,u as M,m as A,a as I,s as Z,E as B}from"./index-_S5NMAtM.js";import{z as w,t as H}from"./index-nA6RVQc-.js";import{i as x}from"./chunk-TC4QW7OA-f9E8bPCK.js";import{u as F}from"./index.esm-tGHRCW3I.js";import{s as L,l as C}from"./chunk-ZFWMN6TD-6kEtnsv-.js";import{E as k,a as z}from"./eye-cJ85NhUl.js";import{U as Q}from"./user-kqCuiKSi.js";import{m as O}from"./chunk-3S23ARPO-Yw7O2sev.js";import{m as $}from"./chunk-EPDLEVDR-xqmjbcc3.js";import{T as Y}from"./trash-2-1opA8veQ.js";import{c as W}from"./chunk-OFH6WYRQ-xOMoTXQb.js";import{m as D}from"./chunk-QY5NICTW-gnTw8yKF.js";import{F as X}from"./Filters-1SZSYirI.js";import{P as K}from"./pen-square-kaJdApUp.js";import{t as ee,a as se,b as ae,c as re,d as te,e as le}from"./chunk-YRZGWF2W-_ko_qycZ.js";import{p as oe}from"./chunk-BIN3WWJN-i0P0xSH1.js";import{g as ne}from"./chunk-KARN4QIT-jIYN-szt.js";import"./import-KCSjf60V.js";import"./import-Ryse5qc9.js";import"./chunk-M3MASYO7-M1EEI2l4.js";import"./chunk-7F3ZLNJ6-E9IbeYNx.js";import"./search-eXsPg-zF.js";import"./chunk-AMSULWPV-lDEPxIJt.js";const ie=w.object({mail:w.string().email({message:"Por favor, ingresa una direcci√≥n de correo electr√≥nico v√°lida"}),first_name:w.string().min(3,{message:"El nombre debe tener al menos 3 caracteres"}),last_name:w.string().min(3,{message:"El apellido debe tener al menos 3 caracteres"}),password:w.string().min(8,{message:"La contrase√±a debe contener al menos 8 caracteres"}),confirmPassword:w.string().min(8,{message:"La contrase√±a de confirmaci√≥n debe contener al menos 8 caracteres"}),role:w.string(),country:w.string().optional()}).refine(l=>l.confirmPassword===l.password,{message:"Las contrase√±as no coinciden",path:["confirmPassword"]});function J({register:l,isManagerSelected:r}){const[u,a]=n.useState([]);return n.useEffect(()=>{(async()=>{try{const o=await fetch("https://apdcc-back-production.up.railway.app/api/countries/all");if(o.ok){const g=await o.json();a(g.response)}}catch(o){throw new Error(o)}})()},[]),e.jsx(L,{className:"max-w-xs dark text-foreground ",...r?{isRequired:!0}:{},label:"Countries",size:"sm",variant:"underlined",color:"default",...l("country"),children:u.map(c=>e.jsx(C,{variant:"flat",className:"uppercase",children:c.name},c._id))})}function G({register:l,setIsManagerSelected:r}){return e.jsxs(L,{isRequired:!0,id:"role",label:"Rol",size:"sm",variant:"underlined",...l("role"),children:[e.jsx(C,{id:"ADMIN",startContent:e.jsx("img",{className:"w-6 h-6 p-1 uppercase bg-black rounded-full",src:"/admin.svg",alt:"icono de admin"}),className:"uppercase",onClick:()=>r(!1),children:"Admin"},"ADMIN"),e.jsx(C,{id:"MANAGER",startContent:e.jsx("img",{className:"w-6 h-6 p-1 uppercase bg-black rounded-full ",src:"/arbitro.svg",alt:"icono de admin"}),className:"uppercase",onClick:()=>r(!0),children:"Coordinador"},"MANAGER"),e.jsx(C,{id:"JUEZ",startContent:e.jsx("img",{className:"w-6 h-6 p-1 uppercase bg-black rounded-full",src:"/manager.svg",alt:"icono de admin"}),className:"uppercase",onClick:()=>r(!1),children:"√Årbitro"},"JUEZ")]})}function ce(){var N,_,f,E,j;const{setRefresh:l}=P(),[r,u]=n.useState(!1),[a,c]=n.useState(!1),[o,g]=n.useState(!1),b=()=>u(!r),t=()=>c(!a),{register:i,handleSubmit:y,formState:{errors:s},reset:p}=F({defaultValues:{mail:"",first_name:"",last_name:"",password:"",confirmPassword:"",role:""},resolver:H(ie)}),d=async R=>{S.promise(async()=>{try{if((await fetch("https://apdcc-back-production.up.railway.app/api/auth/register",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(R)})).ok)return l(),p(),"¬°Registro Exitoso! üòÑ ¬°Bienvenid@!";throw new Error("Oops, algo sali√≥ mal en el registro. üòï")}catch(m){throw console.log(m),m}},{loading:"Loading...",success:m=>m,error:m=>m.message})};return e.jsxs("form",{className:"flex flex-col items-center justify-center gap-3 ",onSubmit:y(d),children:[e.jsx(x,{label:"Email",id:"mail",isRequired:!0,type:"email",size:"lg",placeholder:"ejemplo",variant:"underlined",color:"default",isInvalid:!1,errorMessage:(N=s.mail)==null?void 0:N.message,...i("mail")}),e.jsxs("div",{className:"flex flex-col w-full gap-4 md:flex-row",children:[e.jsx(x,{type:"text",id:"first_name",isRequired:!0,size:"lg",label:"Nombre",variant:"underlined",placeholder:"Juan",className:"max-w-xs",color:"default",isInvalid:!1,errorMessage:(_=s.first_name)==null?void 0:_.message,...i("first_name")}),e.jsx(x,{type:"text",id:"last_name",isRequired:!0,size:"lg",label:"Apellido",variant:"underlined",placeholder:"Perez",className:"max-w-xs",color:"default",isInvalid:!1,errorMessage:(f=s.last_name)==null?void 0:f.message,...i("last_name")})]}),e.jsxs("div",{className:"flex flex-col order-3 w-full gap-4 md:flex-row",children:[e.jsx(x,{label:"Contrase√±a",id:"password",isRequired:!0,size:"lg",variant:"underlined",placeholder:"Ingrese su contrase√±a",color:"default",isInvalid:!1,errorMessage:(E=s.password)==null?void 0:E.message,endContent:e.jsx("button",{className:"focus:outline-none",type:"button",onClick:b,children:r?e.jsx(k,{size:22,className:"text-2xl pointer-events-none text-default-400"}):e.jsx(z,{size:22,className:"text-2xl pointer-events-none text-default-400"})}),type:r?"text":"password",className:"max-w-xs ",...i("password")}),e.jsx(x,{label:"Repetir contrase√±a",id:"confirmPassword",isRequired:!0,size:"lg",variant:"underlined",placeholder:"Repita su contrase√±a",color:"default",isInvalid:!1,errorMessage:(j=s.confirmPassword)==null?void 0:j.message,endContent:e.jsx("button",{className:"focus:outline-none",type:"button",onClick:t,children:a?e.jsx(k,{size:22,className:"text-2xl pointer-events-none text-default-400"}):e.jsx(z,{size:22,className:"text-2xl pointer-events-none text-default-400"})}),type:a?"text":"password",className:"max-w-xs",...i("confirmPassword")})]}),e.jsxs("div",{className:"flex flex-col order-first w-full gap-4 md:flex-row",children:[e.jsx(G,{register:i,setIsManagerSelected:g}),o&&e.jsx(J,{register:i,isManagerSelected:o})]}),e.jsx(v,{type:"submit",className:"order-last w-full mt-2 uppercase font-semibold bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",children:"Registrar"})]})}function de(){const{isOpen:l,onOpen:r,onOpenChange:u}=M();return e.jsxs(e.Fragment,{children:[e.jsx(v,{onPress:r,variant:"faded",color:"default",className:"mb-3",radius:"sm",children:"Nuevo Usuario"}),e.jsx(A,{isOpen:l,onOpenChange:u,size:"2xl",backdrop:"blur",className:"border dark text-foreground border-default-400",children:e.jsx(I,{children:a=>e.jsxs(e.Fragment,{children:[e.jsxs(O,{className:"flex items-start gap-1",children:[e.jsx(Q,{size:22}),"Registrar nuevo usuario"]}),e.jsx($,{className:"pb-10",children:e.jsx(ce,{})})]})})})]})}function me({id:l,role:r,name:u}){const{setRefresh:a}=P(),{isOpen:c,onOpen:o,onOpenChange:g}=M(),b=async()=>{S.promise(async()=>{try{if((await fetch(`https://apdcc-back-production.up.railway.app/api/auth/${l}`,{method:"DELETE",credentials:"include"})).ok)return a(),"¬°Usuario eliminado con √©xito! üòÑ";throw new Error("Oops, algo sali√≥ mal üòï")}catch(t){throw new Error("Error al procesar la solicitud: "+t.message)}},{loading:"Loading...",success:t=>t,error:t=>t.message})};return e.jsxs(e.Fragment,{children:[e.jsx(v,{isIconOnly:!0,onPress:o,color:"danger",size:"sm",className:"transition-all bg-danger/40 hover:bg-danger duration-350",children:e.jsx(Y,{size:18})}),e.jsx(A,{size:"xl",isOpen:c,onOpenChange:g,className:"border dark text-foreground border-default-400",children:e.jsx(I,{children:t=>e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"flex flex-col gap-1 uppercase",children:"‚ö†Ô∏è Advertencia"}),e.jsx($,{children:e.jsxs("div",{children:["Est√° a punto de eliminar un ",e.jsx(W,{children:r})," (",u,"). Esta acci√≥n es permanente y no se puede deshacer. ¬øEst√° seguro de que desea continuar?"]})}),e.jsx(D,{children:e.jsx(v,{className:"font-semibold uppercase rounded-md bg-danger/50 hover:bg-danger",onPress:()=>{b(),t()},children:"Eliminar"})})]})})})]})}function ue({id:l,role:r,name:u,state:a}){const{setRefresh:c}=P(),{isOpen:o,onOpen:g,onOpenChange:b}=M(),[t,i]=n.useState(!1),[y,s]=n.useState(!1),[p,d]=n.useState(!1),N=()=>i(!t),_=()=>s(!y),{register:f,handleSubmit:E,formState:{errors:j}}=F({defaultValues:{first_name:""}}),R=async m=>{S.promise(async()=>{try{if((await fetch(`https://apdcc-back-production.up.railway.app/api/auth/${l}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(m)})).ok)return c(),"¬°Usuario editado con √©xito! üòÑ";throw new Error("Oops, algo sali√≥ mal üòï")}catch(h){throw new Error("Error al procesar la solicitud: "+h.message)}},{loading:"Loading...",success:h=>h,error:h=>h.message})};return e.jsxs(e.Fragment,{children:[e.jsx(v,{isIconOnly:!0,onPress:g,color:"default",size:"sm",className:`${a==="READY"?"opacity-0 cursor-default pointer-events-none":"opacity-100"} bg-default/50 text-default-400 hover:text-white`,children:e.jsx(K,{size:18})}),e.jsx(A,{size:"2xl",isOpen:o,onOpenChange:b,className:"border dark text-foreground border-default-400",children:e.jsx(I,{children:m=>{var h,U,q,V,T;return e.jsxs(e.Fragment,{children:[e.jsx(O,{className:"flex flex-col gap-1 uppercase",children:"‚ö†Ô∏è Advertencia"}),e.jsxs($,{children:[e.jsx("p",{children:"Esta acci√≥n es permanente y no se puede deshacer."}),e.jsxs("form",{className:"flex flex-col items-center justify-center gap-3 ",children:[e.jsx(x,{label:"Email",id:"mail",isRequired:!0,type:"email",size:"lg",placeholder:"ejemplo",variant:"underlined",color:"default",isInvalid:!1,errorMessage:(h=j.mail)==null?void 0:h.message,...f("mail")}),e.jsxs("div",{className:"flex flex-col w-full gap-4 md:flex-row",children:[e.jsx(x,{type:"text",id:"first_name",isRequired:!0,size:"lg",label:"Nombre",variant:"underlined",placeholder:"Juan",className:"max-w-xs",color:"default",isInvalid:!1,errorMessage:(U=j.first_name)==null?void 0:U.message,...f("first_name")}),e.jsx(x,{type:"text",id:"last_name",isRequired:!0,size:"lg",label:"Apellido",variant:"underlined",placeholder:"Perez",className:"max-w-xs",color:"default",isInvalid:!1,errorMessage:(q=j.last_name)==null?void 0:q.message,...f("last_name")})]}),e.jsxs("div",{className:"flex flex-col order-3 w-full gap-4 md:flex-row",children:[e.jsx(x,{label:"Contrase√±a",id:"password",isRequired:!0,size:"lg",variant:"underlined",placeholder:"Ingrese su contrase√±a",color:"default",isInvalid:!1,errorMessage:(V=j.password)==null?void 0:V.message,endContent:e.jsx("button",{className:"focus:outline-none",type:"button",onClick:N,children:t?e.jsx(k,{size:22,className:"text-2xl pointer-events-none text-default-400"}):e.jsx(z,{size:22,className:"text-2xl pointer-events-none text-default-400"})}),type:t?"text":"password",className:"max-w-xs ",...f("password")}),e.jsx(x,{label:"Repetir contrase√±a",id:"confirmPassword",isRequired:!0,size:"lg",variant:"underlined",placeholder:"Repita su contrase√±a",color:"default",isInvalid:!1,errorMessage:(T=j.confirmPassword)==null?void 0:T.message,endContent:e.jsx("button",{className:"focus:outline-none",type:"button",onClick:_,children:y?e.jsx(k,{size:22,className:"text-2xl pointer-events-none text-default-400"}):e.jsx(z,{size:22,className:"text-2xl pointer-events-none text-default-400"})}),type:y?"text":"password",className:"max-w-xs",...f("confirmPassword")})]}),e.jsxs("div",{className:"flex flex-col order-first w-full gap-4 md:flex-row",children:[e.jsx(G,{register:f,setIsManagerSelected:d}),e.jsx(J,{register:f})]})]})]}),e.jsx(D,{children:e.jsx(v,{variant:"solid",radius:"sm",className:"font-semibold uppercase bg-primary/60 hover:bg-primary",onPress:()=>{E(R)(),m()},children:"Editar"})})]})}})})]})}const pe=[{label:"nombre",key:"name"},{label:"funci√≥n",key:"role"},{label:"country",key:"country"},{label:"email",key:"mail"},{label:"acciones",key:"actions"}],fe=function(){const{refresh:r,isHiddenTopBar:u}=P(),[a,c]=n.useState({docs:[],totalDocs:0,limit:10,totalPages:0,page:0,pagingCounter:0,hasPrevPage:!1,hasNextPage:!1,prevPage:null,nextPage:null}),[o,g]=n.useState({category_id:{name:""}}),[b,t]=n.useState(!0),[i,y]=n.useState(1);return n.useEffect(()=>{(async()=>{const p=`https://apdcc-back-production.up.railway.app/api/auth/all?page=${i}`;try{const d=await fetch(p,{method:"GET",credentials:"include",headers:{queries:JSON.stringify(o)}});if(d.ok){const N=await d.json();c(N.response)}}catch(d){throw new Error(d)}finally{t(!1)}})()},[i,o,r]),e.jsxs("section",{className:` ${u?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16 lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between w-full gap-4 pb-4 ",children:[e.jsx(de,{}),e.jsx(X,{setQueries:g,queries:o,countriesFilter:!0})]}),e.jsxs("div",{className:"flex items-center justify-between px-3",children:[e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["Total ",a.totalDocs," usuarios"]}),e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["P√°gina ",a.page]})]}),e.jsxs(ee,{"aria-label":"Users Table",bottomContent:a.page>0?e.jsx("div",{className:`${a.docs?"opacity-100":"opacity-0"} flex items-center justify-center w-full gap-4`,children:e.jsx(oe,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:a.page,total:a.totalPages,onChange:s=>y(s)})}):null,children:[e.jsx(se,{columns:pe,children:s=>e.jsx(ae,{className:"uppercase",allowsSorting:s.key!=="country"&&s.key!=="actions",children:s.label},s.key)}),e.jsx(re,{emptyContent:b?" ":a.docs.length===0?"No se encontraron usuarios":"",items:a.docs,isLoading:b,loadingContent:e.jsx(Z,{className:"mt-12",label:"Loading..."}),children:s=>e.jsx(te,{children:p=>{var d;return e.jsx(le,{children:p==="name"?e.jsx(B,{avatarProps:{size:"sm",className:"p-2",radius:"sm",src:s.role==="ADMIN"?"/admin.svg":s.role==="MANAGER"?"/manager.svg":"/arbitro.svg"},name:`${s.first_name} ${s.last_name}`}):p==="role"?e.jsx("p",{className:"capitalize",children:s.role==="JUEZ"?"√Årbitro":s.role==="MANAGER"?"Coordinador":s.role.toLowerCase()}):p==="actions"?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ue,{id:s._id,role:s.role,name:`${s.first_name} ${s.last_name}`}),e.jsx(me,{id:s._id,role:s.role,name:`${s.first_name} ${s.last_name}`})]}):p==="country"?e.jsx("p",{children:(d=s.country_id)!=null&&d.name?s.country_id.name.toLowerCase():"-"}):ne(s,p)})}},s._id)})]})]})},qe=fe;export{qe as default};
