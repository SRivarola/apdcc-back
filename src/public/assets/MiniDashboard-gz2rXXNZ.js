import{r as l,h as _,j as e,l as R,b as x,k as $,o as q,a1 as M,A as v,a as w,m as N,c as k,s as L,ae as Y}from"./index-DCjOH8AU.js";import{i as C}from"./chunk-TC4QW7OA-rw8c2GU3.js";import{s as b,l as f}from"./chunk-ZFWMN6TD-l4ena-VX.js";import{m as E}from"./chunk-3S23ARPO-Tg7NdpUe.js";import{m as D}from"./chunk-EPDLEVDR-vrYZ5IBb.js";import{T as z}from"./trash-2-BUX-QxB-.js";import{m as A}from"./chunk-QY5NICTW-zhjauiDs.js";import{t as H,a as I,b as J,c as B,d as V,e as W}from"./chunk-YRZGWF2W-TeM7OBhX.js";import{p as G}from"./chunk-BIN3WWJN-oU8JFqev.js";import{g as K}from"./chunk-KARN4QIT-jqAEh8Pt.js";import"./import-SooKWkA1.js";import"./import-TOm_-0HU.js";import"./chunk-M3MASYO7-A7fsmqpY.js";import"./import-qh9-411s.js";import"./chunk-7F3ZLNJ6-QlHTBwmP.js";import"./chunk-AMSULWPV-4Weq8d1d.js";import"./index-taukuCH3.js";const Q=({onClose:i})=>{const[c,o]=l.useState([]),[d,m]=l.useState([]),[g,u]=l.useState([]),[t,n]=l.useState({title:"",location:"",sport:"",category_id:"",date:"",list:[]}),[s,p]=l.useState(!1),{setRefresh:S}=_(),F=async()=>{try{const a=await $();if(a.ok){const r=await a.json();o(r.response)}}catch(a){throw a}},O=async()=>{try{const a=await q();if(a.ok){const j=(await a.json()).response.filter(y=>y.name==="6-7"||y.name==="8-9");m(j)}}catch(a){throw a}},P=async()=>{try{const a=await M(`sport=${t.sport}&category_id=${t.category_id}`);if(a.ok){const r=await a.json();u(r.response)}}catch(a){throw a}},h=(a,r)=>{n(j=>({...j,[a]:r}))},T=async a=>{p(!0),a.preventDefault(),v.promise(async()=>{try{if((await fetch("https://apdcc.com.ar/api/publications/create",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)})).ok)return S(),"¡Creación Exitosa! 😄";throw new Error("Oops, algo salió mal en el creación. 😕")}catch(r){console.log(r)}finally{p(!1),i()}},{loading:"Loading...",success:r=>r,error:r=>r.message})};return l.useEffect(()=>{F(),O()},[]),l.useEffect(()=>{t.category_id&&t.sport&&P()},[t]),e.jsxs("form",{className:"relative grid grid-cols-12 gap-4",children:[e.jsx(C,{label:"Titulo",isRequired:!0,placeholder:"Títilo de la publicación",className:"col-span-4",variant:"underlined",onChange:a=>h("title",a.target.value.toLocaleLowerCase())}),e.jsx(C,{label:"Fecha",type:"date",isRequired:!0,placeholder:"Fecha del encuentro",className:"col-span-4",variant:"underlined",onChange:a=>h("date",R(a.target.value).format("YYYY-MM-DD"))}),e.jsx(b,{label:"Sede",className:"col-span-4",variant:"underlined",isRequired:!0,onChange:a=>h("location",a.target.value),children:c.map(a=>e.jsx(f,{value:a._id,children:a.name},a._id))}),e.jsxs(b,{label:"Deporte",className:"col-span-4",variant:"underlined",isRequired:!0,onChange:a=>h("sport",a.target.value),children:[e.jsx(f,{value:"F7",children:"Futbol"},"F7"),e.jsx(f,{value:"HOCKEY",children:"Hockey"},"HOCKEY")]}),e.jsx(b,{label:"Categoría",className:"col-span-4",variant:"underlined",isRequired:!0,onChange:a=>h("category_id",a.target.value),children:d.map(a=>e.jsx(f,{value:a._id,children:a.name},a._id))}),e.jsx(b,{label:"Equipos",className:"col-span-4",variant:"underlined",selectionMode:"multiple",isRequired:!0,onChange:a=>h("list",a.target.value.split(",")),children:g.map(a=>e.jsx(f,{value:a._id,children:a.name},a._id))}),e.jsx("div",{className:"col-span-4"}),e.jsx("div",{className:"col-span-12 flex justify-end",children:e.jsx(x,{className:"col-span-12 font-semibold uppercase ms-auto bg-primary/60 hover:bg-primary",type:"submit",radius:"sm",isDisabled:s,onClick:a=>T(a),children:"Crear"})})]})},U=()=>{const{isOpen:i,onOpen:c,onOpenChange:o}=w();return e.jsxs(e.Fragment,{children:[e.jsx(x,{onPress:c,variant:"faded",color:"default",className:"mb-3",radius:"sm",children:"Nueva Pulicación"}),e.jsx(N,{isOpen:i,onOpenChange:o,size:"5xl",backdrop:"blur",className:"border dark text-foreground border-default-400",children:e.jsx(k,{children:d=>e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"flex items-start gap-1",children:"Crear nueva publicación"}),e.jsx(D,{className:"pb-10",children:e.jsx(Q,{onClose:d})})]})})})]})},X=U,Z=({id:i,title:c})=>{const{setRefresh:o}=_(),{isOpen:d,onOpen:m,onOpenChange:g}=w(),u=async t=>{v.promise(async()=>{try{if((await fetch(`https://apdcc.com.ar/api/publications/${i}`,{method:"DELETE",credentials:"include"})).ok)return o(),"¡Jugador/a eliminado/a con éxito! 😄";throw new Error("Oops, algo salió mal 😕")}catch(n){throw new Error("Error al procesar la solicitud: "+n.message)}finally{t()}},{loading:"Loading...",success:n=>n,error:n=>n.message})};return e.jsxs(e.Fragment,{children:[e.jsx(x,{isIconOnly:!0,onPress:m,color:"danger",size:"sm",className:"transition-all bg-danger/40 hover:bg-danger duration-350",children:e.jsx(z,{size:18})}),e.jsx(N,{size:"xl",isOpen:d,onOpenChange:g,className:"border dark text-foreground border-default-400",children:e.jsx(k,{children:t=>e.jsxs(e.Fragment,{children:[e.jsx(E,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Warning"}),e.jsx(D,{children:e.jsxs("p",{children:["Esta seguro que desea borrar la publicación:",e.jsx("span",{className:"ml-2 font-semibold",children:c})]})}),e.jsx(A,{children:e.jsx(x,{color:"primary",variant:"solid",radius:"sm",className:"font-semibold uppercase rounded-md bg-danger/50 hover:bg-danger",onPress:()=>u(t),children:"Eliminar"})})]})})})]})},ee=Z,ae=[{label:"Titulo",key:"title"},{label:"Sede",key:"location"},{label:"Deporte",key:"sport"},{label:"Categoria",key:"category_id"},{label:"Acciones",key:"actions"}];function je(){const{isHiddenTopBar:i,refresh:c}=_(),[o,d]=l.useState([]),[m,g]=l.useState(1),[u,t]=l.useState(!0),n=async()=>{const s=await Y(m);d(s.response),t(!1)};return l.useEffect(()=>{n()},[m,c]),e.jsxs("section",{className:`${i?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16  lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:[e.jsx("div",{className:"flex flex-wrap items-start justify-between w-full gap-4 pb-4 ",children:e.jsx(X,{})}),e.jsxs(H,{"aria-label":"Publications Table",bottomContent:o.page>0?e.jsx("div",{className:`${o.docs?"opacity-100":"opacity-0"} flex items-center justify-center w-full gap-4`,children:e.jsx(G,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:o.page,total:o.totalPages,onChange:s=>{t(!0),g(s)}})}):null,children:[e.jsx(I,{columns:ae,children:s=>e.jsx(J,{className:"uppercase",children:s.label},s.key)}),e.jsx(B,{emptyContent:u?" ":o.docs.length===0?"No se encontraron publicaiones":"",items:u?[]:o.docs,isLoading:u,loadingContent:e.jsx(L,{className:"mt-12",label:"Loading..."}),children:s=>e.jsx(V,{children:p=>e.jsx(W,{className:"capitalize",children:p==="location"?e.jsx("p",{children:s.location.name}):p==="category_id"?e.jsx("p",{children:s.category_id.name}):p==="actions"?e.jsx(ee,{id:s._id,title:s.title}):K(s,p)})},s._id)})]})]})}export{je as default};
