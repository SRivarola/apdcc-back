import{r as l,j as e,s as y,t as g,h as x,a as w,b as f,m as _,c as N,A as C,a4 as T}from"./index-VvZd78hb.js";import{c as F}from"./chunk-OFH6WYRQ-limrOt9T.js";import{u as v}from"./index.esm-kB1AuYo6.js";import{m as S}from"./chunk-3S23ARPO-4gRFAw0N.js";import{m as P}from"./chunk-EPDLEVDR-kSpipos2.js";import{i as E}from"./chunk-TC4QW7OA-MMqvt8QS.js";import{m as k}from"./chunk-QY5NICTW-MjCxIN7Y.js";import{P as L}from"./pen-square-lh6DxN_M.js";import{F as $}from"./Filters-c2aSwC25.js";import{d as M}from"./index-5kfDUGsH.js";import{t as A,a as R,b as q,c as I,d as V,e as z}from"./chunk-YRZGWF2W-Z1iX51B9.js";import{p as D}from"./chunk-BIN3WWJN-F7X9bltp.js";import{g as J}from"./chunk-KARN4QIT-N1XteOG1.js";import"./chunk-M3MASYO7-OFLyqJrz.js";import"./import-0MxdbhMt.js";import"./import-QVemTVAh.js";import"./search-r2KlgJJ-.js";import"./chunk-ZFWMN6TD-1AhpLMHp.js";import"./import-uMPj0T_W.js";import"./chunk-7F3ZLNJ6-k3Ez2UGu.js";import"./chunk-MA2FG3JE-RTqaMYcR.js";import"./chunk-AMSULWPV-Gpf6ygp6.js";import"./index-taukuCH3.js";function U({id:m}){const[c,d]=l.useState(!0),[s,n]=l.useState(null);return l.useEffect(()=>{(async()=>{try{const o=await fetch(`https://apdcc.com.ar/api/auth/bycountry/${m}`,{method:"GET",credentials:"include",headers:{token:g}});if(o.ok){const i=await o.json();n(i)}}catch(o){console.error(o)}finally{d(!1)}})()},[]),c?e.jsx(y,{}):s?e.jsxs("p",{children:[s.first_name," ",s.last_name]}):e.jsx(F,{color:"warning",variant:"flat",children:"No asignado"})}function B(){const{setRefresh:m}=x(),{isOpen:c,onOpen:d,onOpenChange:s}=w(),{register:n,handleSubmit:u,formState:{errors:o}}=v({defaultValues:{name:""}}),i=async r=>{r.name=r.name.toLowerCase(),C.promise(async()=>{try{if((await fetch("https://apdcc.com.ar/api/countries/create",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",token:g},body:JSON.stringify(r)})).ok)return m(),"Country creado con Ã©xito ðŸ˜€";throw new Error("Oops, algo saliÃ³ mal ðŸ˜•")}catch(a){throw new Error("Error al procesar la solicitud: "+a.message)}},{loading:"Loading...",success:a=>a,error:a=>a.message})};return e.jsxs(e.Fragment,{children:[e.jsx(f,{onPress:d,variant:"faded",color:"default",className:"mb-3",radius:"sm",children:"Nuevo Country"}),e.jsx(_,{isOpen:c,onOpenChange:s,className:"border dark text-foreground border-default-400",children:e.jsx(N,{children:r=>e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"flex flex-col gap-1",children:"Crear Nuevo Country"}),e.jsx(P,{children:e.jsx(E,{placeholder:"Ingrese el nombre",variant:"underlined",label:"Nombre",isRequired:!0,...n("name")})}),e.jsx(k,{children:e.jsx(f,{className:"font-semibold uppercase bg-primary/60 hover:bg-primary",type:"submit",radius:"sm",onPress:()=>{u(i)(),r()},children:"Crear"})})]})})})]})}function G({id:m}){const{setRefresh:c}=x(),{isOpen:d,onOpen:s,onOpenChange:n}=w(),{register:u,handleSubmit:o}=v({defaultValues:{name:""}}),i=async r=>{C.promise(async()=>{try{if((await fetch(`https://apdcc.com.ar/api/countries/${m}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",token:g},body:JSON.stringify(r)})).ok)return c(),"Â¡Country editado con Ã©xito! ðŸ˜„";throw new Error("Oops, algo saliÃ³ mal ðŸ˜•")}catch(a){throw new Error("Error al procesar la solicitud: "+a.message)}},{loading:"Loading...",success:a=>a,error:a=>a.message})};return e.jsxs(e.Fragment,{children:[e.jsx(f,{isIconOnly:!0,onPress:s,color:"default",size:"sm",className:"bg-default/50 text-default-400 hover:text-white",children:e.jsx(L,{size:18})}),e.jsx(_,{isOpen:d,onOpenChange:n,className:"border dark text-foreground border-default-400",children:e.jsx(N,{children:r=>e.jsxs(e.Fragment,{children:[e.jsx(S,{className:"flex flex-col gap-1 uppercase",children:"âš ï¸ Advertencia"}),e.jsxs(P,{children:[e.jsx("div",{children:"Esta acciÃ³n es permanente y no se puede deshacer."}),e.jsx(E,{placeholder:"Nuevo nombre",label:"Nombre",isRequired:!0,variant:"underlined",...u("name")})]}),e.jsx(k,{children:e.jsx(f,{className:"uppercase font-semibold bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",onPress:()=>{o(i)(),r()},children:"Editar"})})]})})})]})}const H=[{label:"country",key:"name"},{label:"manager",key:"manager"},{label:"acciones",key:"actions"}],h={docs:[],totalDocs:0,limit:10,totalPages:0,page:0,pagingCounter:0,hasPrevPage:!1,hasNextPage:!1,prevPage:null,nextPage:null},Q=function(){const{refresh:c,isHiddenTopBar:d}=x(),[s,n]=l.useState(h),[u,o]=l.useState(!0),[i,r]=l.useState(1),[a,b]=l.useState({name:""}),j=async()=>{const t=await T(i,a);if(t.ok){const p=await t.json();n(p.response)}o(!1)};l.useEffect(()=>{r(1),n(h),j()},[a,c]),l.useEffect(()=>{n(h),j()},[i]);const O=M(t=>{b({...a,name:t.target.value.toLowerCase()})},200);return e.jsxs("section",{className:` ${d?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16 lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between w-full gap-4 pb-4 ",children:[e.jsx(B,{}),e.jsx($,{setQueries:b,inputSearch:!0,handleInputSearch:O})]}),e.jsxs("div",{className:"flex items-center justify-between px-3",children:[e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["Total ",s.totalDocs," countries"]}),e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["PÃ¡gina ",s.page]})]}),e.jsxs(A,{"aria-label":"Users Table",bottomContent:s.page>0?e.jsx("div",{className:`${s.docs?"opacity-100":"opacity-0"} flex items-center justify-center w-full gap-4`,children:e.jsx(D,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:s.page,total:s.totalPages,onChange:t=>{o(!0),r(t)}})}):null,children:[e.jsx(R,{columns:H,children:t=>e.jsx(q,{className:"uppercase",allowsSorting:t.key!=="country"&&t.key!=="actions",children:t.label},t.key)}),e.jsx(I,{emptyContent:u?" ":s.docs.length===0?"No se encontraron countries":"",items:s.docs,isLoading:u,loadingContent:e.jsx(y,{className:"mt-12",label:"Loading..."}),children:t=>e.jsx(V,{children:p=>e.jsxs(z,{className:"capitalize",children:[p==="manager"&&e.jsx(U,{id:t._id}),p==="actions"?e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(G,{id:t._id})}):J(t,p)]})},t.name)})]})]})},be=Q;export{be as default};
