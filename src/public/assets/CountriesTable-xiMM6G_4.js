import{r as i,j as e,s as b,f as g,u as j,b as f,m as y,a as w,A as C}from"./index-FwVaO3z1.js";import{c as O}from"./chunk-OFH6WYRQ-mtk3kVLR.js";import{u as N}from"./index.esm-EQvby6cp.js";import{m as _}from"./chunk-3S23ARPO-jhLsQz9_.js";import{m as v}from"./chunk-EPDLEVDR-5B0VgJbK.js";import{i as x}from"./chunk-TC4QW7OA-Y2BWcliY.js";import{m as S}from"./chunk-QY5NICTW-L2B7L904.js";import{P as T}from"./pen-square-EoRZzRYA.js";import{S as $}from"./search-wmm1kURI.js";import{t as F,a as L,b as A,c as M,d as R,e as z}from"./chunk-YRZGWF2W-Tye6pym6.js";import{p as D}from"./chunk-BIN3WWJN-z_SKtial.js";import{g as I}from"./chunk-KARN4QIT-cUjvN_la.js";import"./chunk-M3MASYO7-87zOWUGj.js";import"./import-4HyJnddH.js";import"./import-UEVUv-oa.js";import"./chunk-AMSULWPV-wF-qDCVJ.js";import"./chunk-7F3ZLNJ6-jei4RYoC.js";function q({id:p}){const[c,d]=i.useState(!0),[a,u]=i.useState(null);return i.useEffect(()=>{(async()=>{try{const o=await fetch(`http://localhost:8080/api/auth/bycountry/${p}`,{method:"GET",credentials:"include"});if(o.ok){const l=await o.json();u(l)}}catch(o){console.error(o)}finally{d(!1)}})()},[]),c?e.jsx(b,{}):a?e.jsxs("p",{children:[a.first_name," ",a.last_name]}):e.jsx(O,{color:"warning",variant:"flat",children:"No asignado"})}function V(){const{setRefresh:p}=g(),{isOpen:c,onOpen:d,onOpenChange:a}=j(),{register:u,handleSubmit:m,formState:{errors:o}}=N({defaultValues:{name:""}}),l=async n=>{C.promise(async()=>{try{if((await fetch("http://localhost:8080/api/countries/create",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)return p(),"Country creado con éxito 😀";throw new Error("Oops, algo salió mal 😕")}catch(s){throw new Error("Error al procesar la solicitud: "+s.message)}},{loading:"Loading...",success:s=>s,error:s=>s.message})};return e.jsxs(e.Fragment,{children:[e.jsx(f,{onPress:d,variant:"faded",color:"default",className:"mb-3",radius:"sm",children:"Nuevo Country"}),e.jsx(y,{isOpen:c,onOpenChange:a,className:"border dark text-foreground border-default-400",children:e.jsx(w,{children:n=>e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"flex flex-col gap-1",children:"Crear Nuevo Country"}),e.jsx(v,{children:e.jsx(x,{placeholder:"Ingrese el nombre",variant:"underlined",label:"Nombre",isRequired:!0,...u("name")})}),e.jsx(S,{children:e.jsx(f,{className:"uppercase font-semibold bg-primary/60 hover:bg-primary",type:"submit",radius:"sm",onPress:()=>{m(l)(),n()},children:"Crear"})})]})})})]})}function B({id:p}){const{setRefresh:c}=g(),{isOpen:d,onOpen:a,onOpenChange:u}=j(),{register:m,handleSubmit:o}=N({defaultValues:{name:""}}),l=async n=>{C.promise(async()=>{try{if((await fetch(`http://localhost:8080/api/countries/${p}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})).ok)return c(),"¡Country editado con éxito! 😄";throw new Error("Oops, algo salió mal 😕")}catch(s){throw new Error("Error al procesar la solicitud: "+s.message)}},{loading:"Loading...",success:s=>s,error:s=>s.message})};return e.jsxs(e.Fragment,{children:[e.jsx(f,{isIconOnly:!0,onPress:a,color:"default",size:"sm",className:"bg-default/50 text-default-400 hover:text-white",children:e.jsx(T,{size:18})}),e.jsx(y,{isOpen:d,onOpenChange:u,className:"border dark text-foreground border-default-400",children:e.jsx(w,{children:n=>e.jsxs(e.Fragment,{children:[e.jsx(_,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Advertencia"}),e.jsxs(v,{children:[e.jsx("div",{children:"Esta acción es permanente y no se puede deshacer."}),e.jsx(x,{placeholder:"Nuevo nombre",label:"Nombre",isRequired:!0,variant:"underlined",...m("name")})]}),e.jsx(S,{children:e.jsx(f,{className:"uppercase font-semibold bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",onPress:()=>{o(l)(),n()},children:"Editar"})})]})})})]})}const G=[{label:"country",key:"name"},{label:"manager",key:"manager"},{label:"acciones",key:"actions"}],J=function(){const{refresh:c,isHiddenTopBar:d}=g(),[a,u]=i.useState({docs:[],totalDocs:0,limit:10,totalPages:0,page:0,pagingCounter:0,hasPrevPage:!1,hasNextPage:!1,prevPage:null,nextPage:null}),[m,o]=i.useState([]),[l,n]=i.useState(!0),[s,P]=i.useState(1);i.useEffect(()=>{(async()=>{const r=`http://localhost:8080/api/countries?page=${s}`;try{const h=await fetch(r,{method:"GET",credentials:"include"});if(h.ok){const k=await h.json();u(k.response)}}catch(h){throw new Error(h)}finally{n(!1)}})()},[s,c]);const E=t=>{const r=a.docs.filter(h=>h.name.toLowerCase().includes(t.toLowerCase()));r.length&&o(r)};return e.jsxs("section",{className:` ${d?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16 lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between w-full gap-4 pb-4 ",children:[e.jsx(V,{}),e.jsx(x,{startContent:e.jsx($,{}),type:"search",size:"sm",variant:"underlined",placeholder:"Buscar",color:"warning",className:"w-[180px]",onChange:t=>{var r;return E((r=t.target)==null?void 0:r.value)}})]}),e.jsxs("div",{className:"flex items-center justify-between px-3",children:[e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["Total ",a.totalDocs," countries"]}),e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["Página ",a.page]})]}),e.jsxs(F,{"aria-label":"Users Table",bottomContent:a.page>0?e.jsx("div",{className:`${a.docs?"opacity-100":"opacity-0"} flex items-center justify-center w-full gap-4`,children:e.jsx(D,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:a.page,total:a.totalPages,onChange:t=>P(t)})}):null,children:[e.jsx(L,{columns:G,children:t=>e.jsx(A,{className:"uppercase",allowsSorting:t.key!=="country"&&t.key!=="actions",children:t.label},t.key)}),e.jsx(M,{emptyContent:l?" ":a.docs.length===0?"No se encontraron countries":"",items:m.length?m:a.docs,isLoading:l,loadingContent:e.jsx(b,{className:"mt-12",label:"Loading..."}),children:t=>e.jsx(R,{children:r=>e.jsxs(z,{className:"capitalize",children:[r==="manager"&&e.jsx(q,{id:t._id}),r==="actions"?e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(B,{id:t._id})}):I(t,r)]})},t.name)})]})]})},ce=J;export{ce as default};
