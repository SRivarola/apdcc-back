import{r as c,j as e,M,i as m,b as C,A as I,a as A,m as O,d as U,O as D,s as Q,a9 as Y,ag as W}from"./index-4RVl-Uey.js";import{z as j,t as X}from"./index-F_H0jPjs.js";import{u as J}from"./index.esm-NmewAg1s.js";import{s as G,l as k}from"./chunk-ZFWMN6TD-nTCRQj3G.js";import{E as R,a as S}from"./eye-B4SFc50B.js";import{U as K}from"./user-pJ9a9Y7I.js";import{m as q}from"./chunk-3S23ARPO-1KrodC8r.js";import{m as T}from"./chunk-EPDLEVDR-FfBA6eQ2.js";import{T as ee}from"./trash-2-CgDLAhUt.js";import{c as se}from"./chunk-OFH6WYRQ-Q44AOqxH.js";import{m as Z}from"./chunk-QY5NICTW-p4l0qgle.js";import{F as ae}from"./Filters-Sy6rQt8U.js";import{P as re}from"./pen-square-_qW9Siwm.js";import{t as te,a as le,b as oe,c as ne,d as ie,e as ce}from"./chunk-YRZGWF2W-bHTByK6d.js";import{p as de}from"./chunk-BIN3WWJN--Y_VBCGu.js";import{g as me}from"./chunk-KARN4QIT-xl_NlJZe.js";import"./chunk-7F3ZLNJ6-rNYo1xCr.js";import"./search-Fbv10Vjf.js";import"./chunk-AMSULWPV-Z-CLL6sE.js";const ue=j.object({mail:j.string().email({message:"Por favor, ingresa una direcci√≥n de correo electr√≥nico v√°lida"}),phone:j.string().min(8,{message:"Por favor, ingresa un n√∫mero de telefono v√°lido"}),first_name:j.string().min(3,{message:"El nombre debe tener al menos 3 caracteres"}),last_name:j.string().min(3,{message:"El apellido debe tener al menos 3 caracteres"}),password:j.string().min(8,{message:"La contrase√±a debe contener al menos 8 caracteres"}),confirmPassword:j.string().min(8,{message:"La contrase√±a de confirmaci√≥n debe contener al menos 8 caracteres"}),role:j.string(),country_id:j.string().optional()}).refine(l=>l.confirmPassword===l.password,{message:"Las contrase√±as no coinciden",path:["confirmPassword"]});function B({register:l,isManagerSelected:t}){const[g,d]=c.useState([]);return c.useEffect(()=>{(async()=>{try{const o=await fetch("https://apdcc.com.ar/api/countries/all");if(o.ok){const u=await o.json();d(u.response)}}catch(o){throw new Error(o)}})()},[]),e.jsx(G,{className:"max-w-xs dark text-foreground ",...t?{isRequired:!0}:{},label:"Countries",size:"sm",variant:"underlined",color:"default",...l("country_id"),children:g.map(a=>e.jsx(k,{variant:"flat",className:"uppercase",value:a._id,children:a.name},a._id))})}function H({register:l,setIsManagerSelected:t}){return e.jsxs(G,{isRequired:!0,id:"role",label:"Rol",size:"sm",variant:"underlined",...l("role"),children:[e.jsx(k,{id:"ADMIN",startContent:e.jsx("img",{className:"w-6 h-6 p-1 uppercase bg-black rounded-full",src:"/admin.svg",alt:"icono de admin"}),className:"uppercase",onClick:()=>t(!1),children:"Admin"},"ADMIN"),e.jsx(k,{id:"MANAGER",startContent:e.jsx("img",{className:"w-6 h-6 p-1 uppercase bg-black rounded-full ",src:"/arbitro.svg",alt:"icono de admin"}),className:"uppercase",onClick:()=>t(!0),children:"Coordinador"},"MANAGER"),e.jsx(k,{id:"JUEZ",startContent:e.jsx("img",{className:"w-6 h-6 p-1 uppercase bg-black rounded-full",src:"/manager.svg",alt:"icono de admin"}),className:"uppercase",onClick:()=>t(!1),children:"√Årbitro"},"JUEZ")]})}function pe(){var i,h,f,z,b,P;const{setRefresh:l}=M(),[t,g]=c.useState(!1),[d,a]=c.useState(!1),[o,u]=c.useState(!1),N=()=>g(!t),r=()=>a(!d),{register:n,handleSubmit:w,formState:{errors:p},reset:E}=J({defaultValues:{mail:"",phone:0,first_name:"",last_name:"",password:"",confirmPassword:"",role:""},resolver:X(ue)}),s=async v=>{v.last_name=v.last_name.toLowerCase();const x={...v,phone:Number(v.phone)};I.promise(async()=>{const y=localStorage.getItem("apdcc_token");try{if((await fetch("https://apdcc.com.ar/api/auth/register",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",token:y},body:JSON.stringify(x)})).ok)return l(),E(),"¬°Registro Exitoso! üòÑ ¬°Bienvenid@!";throw new Error("Oops, algo sali√≥ mal en el registro. üòï")}catch(_){throw console.log(_),_}},{loading:"Loading...",success:y=>y,error:y=>y.message})};return e.jsxs("form",{className:"flex flex-col items-center justify-center gap-3 ",onSubmit:w(s),children:[e.jsxs("div",{className:"flex flex-col w-full gap-4 md:flex-row",children:[e.jsx(m,{label:"Email",id:"mail",isRequired:!0,type:"email",size:"lg",placeholder:"ejemplo",variant:"underlined",color:"default",isInvalid:!1,errorMessage:(i=p.mail)==null?void 0:i.message,...n("mail")}),e.jsx(m,{label:"Telefono",id:"phone",type:"number",size:"lg",placeholder:"1131474847",variant:"underlined",color:"default",isInvalid:!1,errorMessage:(h=p.phone)==null?void 0:h.message,...n("phone")})]}),e.jsxs("div",{className:"flex flex-col w-full gap-4 md:flex-row",children:[e.jsx(m,{type:"text",id:"first_name",isRequired:!0,size:"lg",label:"Nombre",variant:"underlined",placeholder:"Juan",className:"max-w-xs",color:"default",isInvalid:!1,errorMessage:(f=p.first_name)==null?void 0:f.message,...n("first_name")}),e.jsx(m,{type:"text",id:"last_name",isRequired:!0,size:"lg",label:"Apellido",variant:"underlined",placeholder:"Perez",className:"max-w-xs",color:"default",isInvalid:!1,errorMessage:(z=p.last_name)==null?void 0:z.message,...n("last_name")})]}),e.jsxs("div",{className:"flex flex-col order-3 w-full gap-4 md:flex-row",children:[e.jsx(m,{label:"Contrase√±a",id:"password",isRequired:!0,size:"lg",variant:"underlined",placeholder:"Ingrese su contrase√±a",color:"default",isInvalid:!1,errorMessage:(b=p.password)==null?void 0:b.message,endContent:e.jsx("button",{className:"focus:outline-none",type:"button",onClick:N,children:t?e.jsx(R,{size:22,className:"text-2xl pointer-events-none text-default-400"}):e.jsx(S,{size:22,className:"text-2xl pointer-events-none text-default-400"})}),type:t?"text":"password",className:"max-w-xs ",...n("password")}),e.jsx(m,{label:"Repetir contrase√±a",id:"confirmPassword",isRequired:!0,size:"lg",variant:"underlined",placeholder:"Repita su contrase√±a",color:"default",isInvalid:!1,errorMessage:(P=p.confirmPassword)==null?void 0:P.message,endContent:e.jsx("button",{className:"focus:outline-none",type:"button",onClick:r,children:d?e.jsx(R,{size:22,className:"text-2xl pointer-events-none text-default-400"}):e.jsx(S,{size:22,className:"text-2xl pointer-events-none text-default-400"})}),type:d?"text":"password",className:"max-w-xs",...n("confirmPassword")})]}),e.jsxs("div",{className:"flex flex-col order-first w-full gap-4 md:flex-row",children:[e.jsx(H,{register:n,setIsManagerSelected:u}),o&&e.jsx(B,{register:n,isManagerSelected:o})]}),e.jsx(C,{type:"submit",className:"order-last w-full mt-2 font-semibold uppercase bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",children:"Registrar"})]})}function fe(){const{isOpen:l,onOpen:t,onOpenChange:g}=A();return e.jsxs(e.Fragment,{children:[e.jsx(C,{onPress:t,variant:"faded",color:"default",className:"mb-3",radius:"sm",children:"Nuevo Usuario"}),e.jsx(O,{isOpen:l,onOpenChange:g,size:"2xl",backdrop:"blur",className:"border dark text-foreground border-default-400",children:e.jsx(U,{children:d=>e.jsxs(e.Fragment,{children:[e.jsxs(q,{className:"flex items-start gap-1",children:[e.jsx(K,{size:22}),"Registrar nuevo usuario"]}),e.jsx(T,{className:"pb-10",children:e.jsx(pe,{})})]})})})]})}function xe({id:l,role:t,name:g}){const{setRefresh:d}=M(),{isOpen:a,onOpen:o,onOpenChange:u}=A(),N=async()=>{I.promise(async()=>{try{if((await fetch(`https://apdcc.com.ar/api/auth/${l}`,{method:"DELETE",credentials:"include",headers:{token:D}})).ok)return d(),"¬°Usuario eliminado con √©xito! üòÑ";throw new Error("Oops, algo sali√≥ mal üòï")}catch(r){throw new Error("Error al procesar la solicitud: "+r.message)}},{loading:"Loading...",success:r=>r,error:r=>r.message})};return e.jsxs(e.Fragment,{children:[e.jsx(C,{isIconOnly:!0,onPress:o,color:"danger",size:"sm",className:"transition-all bg-danger/40 hover:bg-danger duration-350",children:e.jsx(ee,{size:18})}),e.jsx(O,{size:"xl",isOpen:a,onOpenChange:u,className:"border dark text-foreground border-default-400",children:e.jsx(U,{children:r=>e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"flex flex-col gap-1 uppercase",children:"‚ö†Ô∏è Advertencia"}),e.jsx(T,{children:e.jsxs("div",{children:["Est√° a punto de eliminar un ",e.jsx(se,{children:t})," (",g,"). Esta acci√≥n es permanente y no se puede deshacer. ¬øEst√° seguro de que desea continuar?"]})}),e.jsx(Z,{children:e.jsx(C,{className:"font-semibold uppercase rounded-md bg-danger/50 hover:bg-danger",onPress:()=>{N(),r()},children:"Eliminar"})})]})})})]})}function ge({id:l,role:t,name:g,state:d}){const{setRefresh:a}=M(),{isOpen:o,onOpen:u,onOpenChange:N}=A(),[r,n]=c.useState(!1),[w,p]=c.useState(!1),[E,s]=c.useState(!1),i=()=>n(!r),h=()=>p(!w),{register:f,handleSubmit:z,formState:{errors:b}}=J({defaultValues:{first_name:""}}),P=async v=>{I.promise(async()=>{try{if((await fetch(`https://apdcc.com.ar/api/auth/${l}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",token:D},body:JSON.stringify(v)})).ok)return a(),"¬°Usuario editado con √©xito! üòÑ";throw new Error("Oops, algo sali√≥ mal üòï")}catch(x){throw new Error("Error al procesar la solicitud: "+x.message)}},{loading:"Loading...",success:x=>x,error:x=>x.message})};return e.jsxs(e.Fragment,{children:[e.jsx(C,{isIconOnly:!0,onPress:u,color:"default",size:"sm",className:`${d==="READY"?"opacity-0 cursor-default pointer-events-none":"opacity-100"} bg-default/50 text-default-400 hover:text-white`,children:e.jsx(re,{size:18})}),e.jsx(O,{size:"2xl",isOpen:o,onOpenChange:N,className:"border dark text-foreground border-default-400",children:e.jsx(U,{children:v=>{var x,y,_,V,$,F;return e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"flex flex-col gap-1 uppercase",children:"‚ö†Ô∏è Advertencia"}),e.jsxs(T,{children:[e.jsx("p",{children:"Esta acci√≥n es permanente y no se puede deshacer."}),e.jsxs("form",{className:"flex flex-col items-center justify-center gap-3 ",children:[e.jsxs("div",{className:"flex flex-col w-full gap-4 md:flex-row",children:[e.jsx(m,{label:"Email",id:"mail",isRequired:!0,type:"email",size:"lg",placeholder:"ejemplo",variant:"underlined",color:"default",isInvalid:!1,errorMessage:(x=b.mail)==null?void 0:x.message,...f("mail")}),e.jsx(m,{label:"Telefono",id:"phone",isRequired:!0,type:"number",size:"lg",placeholder:"1131474847",variant:"underlined",color:"default",isInvalid:!1,errorMessage:(y=b.phone)==null?void 0:y.message,...f("phone")})]}),e.jsxs("div",{className:"flex flex-col w-full gap-4 md:flex-row",children:[e.jsx(m,{type:"text",id:"first_name",isRequired:!0,size:"lg",label:"Nombre",variant:"underlined",placeholder:"Juan",className:"max-w-xs",color:"default",isInvalid:!1,errorMessage:(_=b.first_name)==null?void 0:_.message,...f("first_name")}),e.jsx(m,{type:"text",id:"last_name",isRequired:!0,size:"lg",label:"Apellido",variant:"underlined",placeholder:"Perez",className:"max-w-xs",color:"default",isInvalid:!1,errorMessage:(V=b.last_name)==null?void 0:V.message,...f("last_name")})]}),e.jsxs("div",{className:"flex flex-col order-3 w-full gap-4 md:flex-row",children:[e.jsx(m,{label:"Contrase√±a",id:"password",isRequired:!0,size:"lg",variant:"underlined",placeholder:"Ingrese su contrase√±a",color:"default",isInvalid:!1,errorMessage:($=b.password)==null?void 0:$.message,endContent:e.jsx("button",{className:"focus:outline-none",type:"button",onClick:i,children:r?e.jsx(R,{size:22,className:"text-2xl pointer-events-none text-default-400"}):e.jsx(S,{size:22,className:"text-2xl pointer-events-none text-default-400"})}),type:r?"text":"password",className:"max-w-xs ",...f("password")}),e.jsx(m,{label:"Repetir contrase√±a",id:"confirmPassword",isRequired:!0,size:"lg",variant:"underlined",placeholder:"Repita su contrase√±a",color:"default",isInvalid:!1,errorMessage:(F=b.confirmPassword)==null?void 0:F.message,endContent:e.jsx("button",{className:"focus:outline-none",type:"button",onClick:h,children:w?e.jsx(R,{size:22,className:"text-2xl pointer-events-none text-default-400"}):e.jsx(S,{size:22,className:"text-2xl pointer-events-none text-default-400"})}),type:w?"text":"password",className:"max-w-xs",...f("confirmPassword")})]}),e.jsxs("div",{className:"flex flex-col order-first w-full gap-4 md:flex-row",children:[e.jsx(H,{register:f,setIsManagerSelected:s}),e.jsx(B,{register:f})]})]})]}),e.jsx(Z,{children:e.jsx(C,{variant:"solid",radius:"sm",className:"font-semibold uppercase bg-primary/60 hover:bg-primary",onPress:()=>{z(P)(),v()},children:"Editar"})})]})}})})]})}const he=[{label:"nombre",key:"name"},{label:"funci√≥n",key:"role"},{label:"country",key:"country"},{label:"telefono",key:"phone"},{label:"email",key:"mail"},{label:"acciones",key:"actions"}],L={docs:[],totalDocs:0,limit:10,totalPages:0,page:0,pagingCounter:0,hasPrevPage:!1,hasNextPage:!1,prevPage:null,nextPage:null},be=function(){const{refresh:t,isHiddenTopBar:g,setRefresh:d}=M(),[a,o]=c.useState(L),[u,N]=c.useState({category_id:{name:""}}),[r,n]=c.useState(!0),[w,p]=c.useState(1);c.useEffect(()=>{o(L),(async()=>{const i=await W(w,u);if(i.ok){const h=await i.json();o(h.response)}setTimeout(()=>{n(!1)},200)})()},[w,t]),c.useEffect(()=>{n(!0),p(1),d()},[u]);function E(s){return s.charAt(0).toUpperCase()+s.slice(1)}return e.jsxs("section",{className:` ${g?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16 lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between w-full gap-4 pb-4 ",children:[e.jsx(fe,{}),e.jsx(ae,{setQueries:N,queries:u,countriesFilter:!0})]}),e.jsxs("div",{className:"flex items-center justify-between px-3",children:[e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["Total ",a.totalDocs," usuarios"]}),e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["P√°gina ",a.page]})]}),e.jsxs(te,{"aria-label":"Users Table",bottomContent:a.page>0?e.jsx("div",{className:`${a.docs?"opacity-100":"opacity-0"} flex items-center justify-center w-full gap-4`,children:e.jsx(de,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:a.page,total:a.totalPages,onChange:s=>{n(!0),p(s)}})}):null,children:[e.jsx(le,{columns:he,children:s=>e.jsx(oe,{className:"uppercase",allowsSorting:s.key!=="country"&&s.key!=="actions",children:s.label},s.key)}),e.jsx(ne,{emptyContent:r?" ":a.docs.length===0?"No se encontraron usuarios":"",items:a.docs,isLoading:r,loadingContent:e.jsx(Q,{className:"mt-12",label:"Loading..."}),children:s=>e.jsx(ie,{children:i=>{var h;return e.jsx(ce,{children:i==="name"?e.jsx(Y,{avatarProps:{size:"sm",className:"p-2",radius:"sm",src:s.role==="ADMIN"?"/admin.svg":s.role==="MANAGER"?"/manager.svg":"/arbitro.svg"},name:`${E(s.last_name)} ${E(s.first_name)}`}):i==="role"?e.jsx("p",{className:"capitalize",children:s.role==="JUEZ"?"√Årbitro":s.role==="MANAGER"?"Coordinador":s.role.toLowerCase()}):i==="actions"?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{id:s._id,role:s.role,name:`${s.first_name} ${s.last_name}`}),e.jsx(xe,{id:s._id,role:s.role,name:`${s.first_name} ${s.last_name}`})]}):i==="country"?e.jsx("p",{children:(h=s.country_id)!=null&&h.name?s.country_id.name.toLowerCase():"-"}):i==="phone"?e.jsx("p",{children:s.phone?s.phone:"-"}):me(s,i)})}},s._id)})]})]})},Te=be;export{Te as default};
