import{r as d,j as e,S as T,X as z,U as A,N as v,i as _,b as x,P as y,A as N,a as w,m as C,d as E,Y as R,s as $,Z as M,_ as I}from"./index-jfKeHs1S.js";import{F as L}from"./Filters-KMgcixE4.js";import{u as P}from"./index.esm-Xr4ioYqg.js";import{s as b,l as h}from"./chunk-ZFWMN6TD-5cWOd0ay.js";import{m as k}from"./chunk-3S23ARPO-E7RfJaD0.js";import{m as S}from"./chunk-EPDLEVDR-4FqJA3rT.js";import{T as V}from"./trash-2-j0Vzco0q.js";import{c as U}from"./chunk-OFH6WYRQ-q0Kwzs6v.js";import{m as q}from"./chunk-QY5NICTW-3AQLmXhP.js";import{P as H}from"./pen-square-5WQWFc1q.js";import{t as Y,a as B,b as G,c as J,d as K,e as Q}from"./chunk-YRZGWF2W-nnBMtjF4.js";import{p as W}from"./chunk-BIN3WWJN-tsGMNp_n.js";import{g as X}from"./chunk-KARN4QIT-oLQwxsHz.js";import"./search-zLEPL2Vg.js";import"./chunk-7F3ZLNJ6-k8NpCfGh.js";import"./chunk-AMSULWPV-ZKvl8Oln.js";function Z({register:u}){const[a,i]=d.useState([]);return d.useEffect(()=>{(async()=>{const l=await T();if(l.ok){const c=await l.json();i(c.response)}})()},[]),e.jsx(b,{className:"max-w-xs",label:"Country",isRequired:!0,size:"sm",variant:"underlined",color:"default",...u("country_id"),children:a.map(r=>e.jsx(h,{variant:"flat",className:"uppercase",children:r.name},r._id))})}function ee({register:u}){const[a,i]=d.useState([]);return d.useEffect(()=>{(async()=>{const l=await z();if(l.ok){const c=await l.json();i(c.response)}})()},[]),e.jsx(b,{className:"max-w-xs",label:"Categoria",size:"sm",isRequired:!0,variant:"underlined",color:"default",...u("category_id"),children:a.map(r=>e.jsx(h,{variant:"flat",className:"uppercase",children:r.name},r._id))})}function se({onClose:u}){const{dataUser:a}=d.useContext(A),{setRefresh:i,adminRole:r}=v(),[l,c]=d.useState(""),[o,p]=d.useState([]),{register:n,handleSubmit:g,reset:j}=P({defaultValues:{name:"",sport:"",genre:"",country_id:"",category_id:"",manager:a._id}});d.useEffect(()=>{(async()=>{try{const s=await fetch("https://apdcc.com.ar:8080/api/auth",{method:"GET",credentials:"include",headers:{token:y}});if(s.ok){const{response:m}=await s.json();p(m)}}catch(s){console.error("Error fetching data:",s)}})()},[]);const f=async t=>{t.name=t.name.toLowerCase();try{let s=!0;if(r==="ADMIN"){const m=o.find(F=>F.country_id===t.country_id),D=o.find(F=>F._id===t.manager);s=m&&m._id===t.manager||D.role==="ADMIN"}if(s)if((await fetch("https://apdcc.com.ar:8080/api/teams/create",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",token:y},body:JSON.stringify(t)})).ok)j(),i(),N.success("¡Creación Exitosa! 😄");else throw new Error("Oops, algo salió mal en la creación. 😕")}catch(s){N.error(s.message)}finally{u()}};return e.jsxs("form",{onSubmit:g(f),children:[e.jsxs("div",{className:"flex items-end gap-4",children:[e.jsx(_,{label:"Nombre",id:"name",isRequired:!0,type:"text",size:"sm",variant:"underlined",color:"default",className:`${r!=="ADMIN"&&"hidden"}`,errorMessage:"",...n("name")}),r==="ADMIN"&&a?e.jsx(b,{className:"max-w-xs text-white",label:"Coordinador",isRequired:!0,size:"sm",variant:"underlined",color:"default",defaultSelectedKeys:[a._id],...n("manager"),children:o==null?void 0:o.map(t=>e.jsx(h,{value:t._id,children:`${t.last_name} ${t.first_name}`},t._id))}):null]}),e.jsxs("div",{className:"flex items-end gap-4",children:[r==="ADMIN"?e.jsx(Z,{register:n}):e.jsx(_,{id:"name",label:"Nombre",placeholder:"Super Campeones FC",isRequired:!0,type:"text",size:"sm",variant:"underlined",color:"default",errorMessage:"",...n("name")}),e.jsxs(b,{className:"max-w-xs",label:"Deporte",isRequired:!0,size:"sm",variant:"underlined",color:"default",...n("sport"),children:[e.jsx(h,{textValue:"futbol7",variant:"flat",className:"uppercase",onClick:()=>c("F7"),children:"Futbol 7"},"F7"),e.jsx(h,{textValue:"futbol11",variant:"flat",className:"uppercase",onClick:()=>c("F11"),children:"Futbol 11"},"F11"),e.jsx(h,{textValue:"hockey",variant:"flat",className:"uppercase",onClick:()=>c("HOCKEY"),children:"Hockey"},"HOCKEY")]})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(ee,{register:n}),e.jsxs(b,{className:"max-w-xs",label:"Genero",size:"sm",isRequired:!0,variant:"underlined",color:"default",...n("genre"),children:[l==="F7"||l==="HOCKEY"?e.jsx(h,{variant:"flat",className:"uppercase",children:"Femenino"},"FEMENINO"):null,l==="HOCKEY"?null:e.jsx(h,{variant:"flat",className:"uppercase",children:"Masculino"},"MASCULINO")]})]}),e.jsx(x,{type:"submit",className:"order-last w-full mt-5 font-semibold uppercase bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",children:"Registrar"})]})}function ae(){const{isOpen:u,onOpen:a,onOpenChange:i}=w();return e.jsxs(e.Fragment,{children:[e.jsx(x,{onPress:a,variant:"faded",color:"default",className:"mb-3",radius:"sm",children:"Nuevo Equipo"}),e.jsx(C,{isOpen:u,onOpenChange:i,size:"lg",backdrop:"blur",className:"border dark text-foreground border-default-400",children:e.jsx(E,{children:r=>e.jsxs(e.Fragment,{children:[e.jsxs(k,{className:"flex items-start gap-1",children:[e.jsx(R,{size:22}),"Registrar nuevo equipo"]}),e.jsx(S,{className:"pb-10",children:e.jsx(se,{onClose:r})})]})})})]})}function re({id:u,name:a,sport:i}){const{setRefresh:r}=v(),{isOpen:l,onOpen:c,onOpenChange:o}=w(),p=async()=>{N.promise(async()=>{try{if((await fetch(`https://apdcc.com.ar:8080/api/teams/${u}`,{method:"DELETE",credentials:"include",headers:{token:y}})).ok)return r(),"¡Equipo eliminado/a con éxito! 😄";throw new Error("Oops, algo salió mal 😕")}catch(n){throw new Error("Error al procesar la solicitud: "+n.message)}},{loading:"Loading...",success:n=>n,error:n=>n.message})};return e.jsxs(e.Fragment,{children:[e.jsx(x,{isIconOnly:!0,onPress:c,color:"danger",size:"sm",className:"transition-all bg-danger/40 hover:bg-danger duration-350",children:e.jsx(V,{size:18})}),e.jsx(C,{size:"xl",isOpen:l,onOpenChange:o,className:"border dark text-foreground border-default-400",children:e.jsx(E,{children:n=>e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Advertencia"}),e.jsx(S,{children:e.jsxs("div",{children:["Está a punto de eliminar al equipo de ",e.jsx("b",{children:i})," ",e.jsx(U,{radius:"sm",className:"capitalize",children:a}),e.jsx("br",{}),"Esta acción es permanente y no se puede deshacer.",e.jsx("br",{})," ¿Está seguro de que desea continuar?"]})}),e.jsx(q,{children:e.jsx(x,{className:"font-semibold uppercase rounded-md bg-danger/50 hover:bg-danger",onPress:()=>{p(),n()},children:"Eliminar"})})]})})})]})}function te(){const{isOpen:u,onOpen:a,onOpenChange:i}=w(),[r,l]=d.useState(""),c=async()=>{N.promise(async()=>{try{if((await fetch("https://apdcc.com.ar:8080/api/players/cleanallteams",{method:"PUT",headers:{token:y}})).ok)return"Equipos vaciados correctamente ♻️"}catch(o){throw new Error("Error al procesar la solicitud: "+o.message)}},{loading:"Loading...",success:o=>o,error:o=>o.message})};return e.jsxs(e.Fragment,{children:[e.jsx(x,{onPress:a,color:"danger",className:"block mt-5 font-semibold uppercase rounded-md ms-auto ",children:"Vaciar equipos"}),e.jsx(C,{isOpen:u,onOpenChange:i,hideCloseButton:!0,className:"border dark text-foreground border-default-400",children:e.jsx(E,{children:o=>e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Warning"}),e.jsxs(S,{children:[e.jsx("div",{children:"Esta acción es permanente y no se puede deshacer. Estás seguro de que quieres continuar?"}),e.jsxs("label",{children:["Ingresá ",e.jsx("span",{className:"font-medium text-danger",children:"vaciarequipos"})," para confirmar.",e.jsx(_,{size:"sm",variant:"faded",name:"key",value:r.toLowerCase(),onValueChange:p=>l(p.toLowerCase())})]})]}),e.jsx(q,{children:e.jsx(x,{isDisabled:r!=="vaciarequipos",color:"primary",className:"w-full font-semibold rounded-md",onPress:()=>{c(),o()},children:"Delete"})})]})})})]})}function ne({id:u,role:a,name:i,state:r}){const{isOpen:l,onOpen:c,onOpenChange:o}=w(),{setRefresh:p}=v(),{register:n,handleSubmit:g}=P({defaultValues:{name:""}}),j=async f=>{N.promise(async()=>{try{if((await fetch(`https://apdcc.com.ar:8080/api/teams/${u}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",token:y},body:JSON.stringify(f)})).ok)return p(),"Equipo editado con éxito! 😄";throw new Error("Oops, algo salió mal 😕")}catch(t){throw new Error("Error al procesar la solicitud: "+t.message)}},{loading:"Loading...",success:t=>t,error:t=>t.message})};return e.jsxs(e.Fragment,{children:[e.jsx(x,{isIconOnly:!0,onPress:c,color:"default",size:"sm",className:`${r==="READY"?"opacity-0 cursor-default pointer-events-none":"opacity-100"} bg-default/50 text-default-400 hover:text-white`,children:e.jsx(H,{size:18})}),e.jsx(C,{isOpen:l,onOpenChange:o,className:"border dark text-foreground border-default-400",children:e.jsx(E,{children:f=>e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Advertencia"}),e.jsxs(S,{children:[e.jsx("p",{children:"Esta acción es permanente y no se puede deshacer."}),e.jsx(_,{placeholder:"Nuevo nombre",label:"Nombre",isRequired:!0,variant:"underlined",...n("name")})]}),e.jsx(q,{children:e.jsx(x,{variant:"solid",radius:"sm",className:"font-semibold uppercase bg-primary/60 hover:bg-primary",onPress:()=>{g(j)(),f()},children:"editar"})})]})})})]})}const oe=[{label:"nombre",key:"name"},{label:"deporte",key:"sport"},{label:"genero",key:"genre"},{label:"country",key:"country_id"},{label:"categoria",key:"category_id"},{label:"acciones",key:"actions"}],O={docs:[],totalDocs:0,limit:10,totalPages:0,page:0,pagingCounter:0,hasPrevPage:!1,hasNextPage:!1,prevPage:null,nextPage:null},le=function(){const[a,i]=d.useState(O),[r,l]=d.useState({country_id:"",genre:"",sport:"",category_id:""}),{refresh:c,isHiddenTopBar:o,adminRole:p}=v(),[n,g]=d.useState(!0),[j,f]=d.useState(1),t=async()=>{const s=await I(j,r);if(s.ok){const{response:m}=await s.json();i(m)}g(!1)};return d.useEffect(()=>{f(1),i(O),t()},[c,r]),d.useEffect(()=>{i(O),t()},[j]),e.jsxs("section",{className:` ${o?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16 lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between w-full gap-4 pb-4 ",children:[e.jsx(ae,{}),e.jsx(L,{setQueries:l,queries:r,countriesFilter:!0,genresFilter:!0,sportsFilter:!0,categoriesFilter:!0})]}),e.jsxs("div",{className:"flex items-center justify-between px-3",children:[e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["Total ",a.totalDocs," equipos"]}),e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["Página ",a.page]})]}),e.jsxs(Y,{"aria-label":"Users Table",bottomContent:a.page>0?e.jsx("div",{className:`${a.docs?"opacity-100":"opacity-0"} flex items-center justify-center w-full gap-4`,children:e.jsx(W,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:a.page,total:a.totalPages,onChange:s=>{g(!0),f(s)}})}):null,children:[e.jsx(B,{columns:oe,children:s=>e.jsx(G,{className:"uppercase",children:s.label},s.key)}),e.jsx(J,{emptyContent:n?" ":a.docs.length===0?"No se encontraron equipos":"",items:a==null?void 0:a.docs,isLoading:n,loadingContent:e.jsx($,{className:"mt-12",label:"Loading..."}),children:s=>e.jsx(K,{children:m=>e.jsx(Q,{className:"capitalize",children:m==="country_id"?e.jsx("p",{children:s.country_id.name}):m==="name"?e.jsx(M,{to:`/dashboard/teams/team/${s._id}`,children:s.name}):m==="category_id"?e.jsx("p",{children:s.category_id.name}):m==="actions"?e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ne,{id:s._id,role:s.role,name:`${s.first_name} ${s.last_name}`}),e.jsx(re,{id:s._id,name:s.name,sport:s.sport})]}):X(s,m)})},s._id)})]}),p==="ADMIN"?e.jsx(te,{}):null]})},we=le;export{we as default};
