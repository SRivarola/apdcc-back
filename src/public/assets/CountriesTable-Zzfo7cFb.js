import{r as i,j as e,s as b,k as h,u as j,b as f,m as y,c as w,i as _,A as N,C as O}from"./index-0u7s5bwV.js";import{c as T}from"./chunk-OFH6WYRQ-3iH88JGo.js";import{u as C}from"./index.esm-BwM-XIqt.js";import{m as v}from"./chunk-3S23ARPO-dSKpVv2j.js";import{m as S}from"./chunk-EPDLEVDR-zICQUcZt.js";import{m as P,P as F}from"./pen-square-VkT_cx_N.js";import{F as $}from"./Filters-2OAkLv4s.js";import{d as L}from"./index-Py6SChNl.js";import{t as M,a as A,b as R,c as q,d as I,e as V}from"./chunk-YRZGWF2W-msHbqfKe.js";import{p as z}from"./chunk-BIN3WWJN-gis9eQ7O.js";import{g as D}from"./chunk-KARN4QIT-DfYvyZkN.js";import"./search-P0Upb5DM.js";import"./chunk-ZFWMN6TD-xzPvSRnf.js";import"./chunk-7F3ZLNJ6-4uEwMwPh.js";import"./chunk-MA2FG3JE-yLPdRcHF.js";import"./chunk-AMSULWPV-zRHH4Jv6.js";function J({id:p}){const[c,d]=i.useState(!0),[s,n]=i.useState(null);return i.useEffect(()=>{(async()=>{try{const r=await fetch(`https://apdcc-back-production.up.railway.app/api/auth/bycountry/${p}`,{method:"GET",credentials:"include"});if(r.ok){const l=await r.json();n(l)}}catch(r){console.error(r)}finally{d(!1)}})()},[]),c?e.jsx(b,{}):s?e.jsxs("p",{children:[s.first_name," ",s.last_name]}):e.jsx(T,{color:"warning",variant:"flat",children:"No asignado"})}function U(){const{setRefresh:p}=h(),{isOpen:c,onOpen:d,onOpenChange:s}=j(),{register:n,handleSubmit:u,formState:{errors:r}}=C({defaultValues:{name:""}}),l=async o=>{N.promise(async()=>{try{if((await fetch("https://apdcc-back-production.up.railway.app/api/countries/create",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)return p(),"Country creado con éxito 😀";throw new Error("Oops, algo salió mal 😕")}catch(a){throw new Error("Error al procesar la solicitud: "+a.message)}},{loading:"Loading...",success:a=>a,error:a=>a.message})};return e.jsxs(e.Fragment,{children:[e.jsx(f,{onPress:d,variant:"faded",color:"default",className:"mb-3",radius:"sm",children:"Nuevo Country"}),e.jsx(y,{isOpen:c,onOpenChange:s,className:"border dark text-foreground border-default-400",children:e.jsx(w,{children:o=>e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"flex flex-col gap-1",children:"Crear Nuevo Country"}),e.jsx(S,{children:e.jsx(_,{placeholder:"Ingrese el nombre",variant:"underlined",label:"Nombre",isRequired:!0,...n("name")})}),e.jsx(P,{children:e.jsx(f,{className:"uppercase font-semibold bg-primary/60 hover:bg-primary",type:"submit",radius:"sm",onPress:()=>{u(l)(),o()},children:"Crear"})})]})})})]})}function B({id:p}){const{setRefresh:c}=h(),{isOpen:d,onOpen:s,onOpenChange:n}=j(),{register:u,handleSubmit:r}=C({defaultValues:{name:""}}),l=async o=>{N.promise(async()=>{try{if((await fetch(`https://apdcc-back-production.up.railway.app/api/countries/${p}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)})).ok)return c(),"¡Country editado con éxito! 😄";throw new Error("Oops, algo salió mal 😕")}catch(a){throw new Error("Error al procesar la solicitud: "+a.message)}},{loading:"Loading...",success:a=>a,error:a=>a.message})};return e.jsxs(e.Fragment,{children:[e.jsx(f,{isIconOnly:!0,onPress:s,color:"default",size:"sm",className:"bg-default/50 text-default-400 hover:text-white",children:e.jsx(F,{size:18})}),e.jsx(y,{isOpen:d,onOpenChange:n,className:"border dark text-foreground border-default-400",children:e.jsx(w,{children:o=>e.jsxs(e.Fragment,{children:[e.jsx(v,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Advertencia"}),e.jsxs(S,{children:[e.jsx("div",{children:"Esta acción es permanente y no se puede deshacer."}),e.jsx(_,{placeholder:"Nuevo nombre",label:"Nombre",isRequired:!0,variant:"underlined",...u("name")})]}),e.jsx(P,{children:e.jsx(f,{className:"uppercase font-semibold bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",onPress:()=>{r(l)(),o()},children:"Editar"})})]})})})]})}const G=[{label:"country",key:"name"},{label:"manager",key:"manager"},{label:"acciones",key:"actions"}],x={docs:[],totalDocs:0,limit:10,totalPages:0,page:0,pagingCounter:0,hasPrevPage:!1,hasNextPage:!1,prevPage:null,nextPage:null},H=function(){const{refresh:c,isHiddenTopBar:d}=h(),[s,n]=i.useState(x),[u,r]=i.useState(!0),[l,o]=i.useState(1),[a,g]=i.useState({name:""});i.useEffect(()=>{n(x),(async()=>{const m=await O(l,a);if(m.ok){const E=await m.json();n(E.response)}r(!1)})()},[l,a,c]);const k=L(t=>{g({...a,name:t.target.value.toLowerCase()})},200);return e.jsxs("section",{className:` ${d?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16 lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between w-full gap-4 pb-4 ",children:[e.jsx(U,{}),e.jsx($,{setQueries:g,inputSearch:!0,handleInputSearch:k})]}),e.jsxs("div",{className:"flex items-center justify-between px-3",children:[e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["Total ",s.totalDocs," countries"]}),e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["Página ",s.page]})]}),e.jsxs(M,{"aria-label":"Users Table",bottomContent:s.page>0?e.jsx("div",{className:`${s.docs?"opacity-100":"opacity-0"} flex items-center justify-center w-full gap-4`,children:e.jsx(z,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:s.page,total:s.totalPages,onChange:t=>{r(!0),o(t)}})}):null,children:[e.jsx(A,{columns:G,children:t=>e.jsx(R,{className:"uppercase",allowsSorting:t.key!=="country"&&t.key!=="actions",children:t.label},t.key)}),e.jsx(q,{emptyContent:u?" ":s.docs.length===0?"No se encontraron countries":"",items:s.docs,isLoading:u,loadingContent:e.jsx(b,{className:"mt-12",label:"Loading..."}),children:t=>e.jsx(I,{children:m=>e.jsxs(V,{className:"capitalize",children:[m==="manager"&&e.jsx(J,{id:t._id}),m==="actions"?e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(B,{id:t._id})}):D(t,m)]})},t.name)})]})]})},de=H;export{de as default};
