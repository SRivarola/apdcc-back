import{r as i,j as e,s as j,f as x,u as y,b as g,m as w,a as _,A as C}from"./index-WqbPWE0E.js";import{c as T}from"./chunk-OFH6WYRQ-oWe43lFJ.js";import{u as N}from"./index.esm-AaNy5cSr.js";import{m as k}from"./chunk-3S23ARPO-eiL4WC3X.js";import{m as S}from"./chunk-EPDLEVDR-54dcRee3.js";import{i as b}from"./chunk-TC4QW7OA-v-iVWaFn.js";import{m as v}from"./chunk-QY5NICTW-_zE6iGR2.js";import{P as $}from"./pen-square-aFwKzsj7.js";import{S as F}from"./search-sQfN_xwV.js";import{t as I,a as L,b as A,c as M,d as R,e as z}from"./chunk-YRZGWF2W-hcMjxO4J.js";import{p as D}from"./chunk-BIN3WWJN-MMgnA3-P.js";import{g as q}from"./chunk-KARN4QIT-0lg9pr17.js";import"./chunk-M3MASYO7-kWQ4oELG.js";import"./import-yG13OaeA.js";import"./import-hIBVkbdo.js";import"./chunk-AMSULWPV-a7khhzyU.js";import"./chunk-7F3ZLNJ6-12qWG1A4.js";function V({id:m}){const[d,u]=i.useState(!0),[l,t]=i.useState(null);return i.useEffect(()=>{(async()=>{const p=localStorage.getItem("apdcc_token");try{const n=await fetch(`https://apdcc-back-production.up.railway.app/api/auth/bycountry/${m}`,{method:"GET",credentials:"include",headers:{token:p}});if(n.ok){const r=await n.json();t(r)}}catch(n){console.error(n)}finally{u(!1)}})()},[]),d?e.jsx(j,{}):l?e.jsxs("p",{children:[l.first_name," ",l.last_name]}):e.jsx(T,{color:"warning",variant:"flat",children:"No asignado"})}function B(){const{setRefresh:m}=x(),{isOpen:d,onOpen:u,onOpenChange:l}=y(),{register:t,handleSubmit:f,formState:{errors:p}}=N({defaultValues:{name:""}}),n=async r=>{C.promise(async()=>{const s=localStorage.getItem("apdcc_token");try{if((await fetch("https://apdcc-back-production.up.railway.app/api/countries/create",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json",token:s},body:JSON.stringify(r)})).ok)return m(),"Country creado con éxito 😀";throw new Error("Oops, algo salió mal 😕")}catch(c){throw new Error("Error al procesar la solicitud: "+c.message)}},{loading:"Loading...",success:s=>s,error:s=>s.message})};return e.jsxs(e.Fragment,{children:[e.jsx(g,{onPress:u,variant:"faded",color:"default",className:"mb-3",radius:"sm",children:"Nuevo Country"}),e.jsx(w,{isOpen:d,onOpenChange:l,className:"border dark text-foreground border-default-400",children:e.jsx(_,{children:r=>e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"flex flex-col gap-1",children:"Crear Nuevo Country"}),e.jsx(S,{children:e.jsx(b,{placeholder:"Ingrese el nombre",variant:"underlined",label:"Nombre",isRequired:!0,...t("name")})}),e.jsx(v,{children:e.jsx(g,{className:"uppercase font-semibold bg-primary/60 hover:bg-primary",type:"submit",radius:"sm",onPress:()=>{f(n)(),r()},children:"Crear"})})]})})})]})}function G({id:m}){const{setRefresh:d}=x(),{isOpen:u,onOpen:l,onOpenChange:t}=y(),{register:f,handleSubmit:p}=N({defaultValues:{name:""}}),n=async r=>{C.promise(async()=>{const s=localStorage.getItem("apdcc_token");try{if((await fetch(`https://apdcc-back-production.up.railway.app/api/countries/${m}`,{method:"PUT",credentials:"include",headers:{"Content-Type":"application/json",token:s},body:JSON.stringify(r)})).ok)return d(),"¡Country editado con éxito! 😄";throw new Error("Oops, algo salió mal 😕")}catch(c){throw new Error("Error al procesar la solicitud: "+c.message)}},{loading:"Loading...",success:s=>s,error:s=>s.message})};return e.jsxs(e.Fragment,{children:[e.jsx(g,{isIconOnly:!0,onPress:l,color:"default",size:"sm",className:"bg-default/50 text-default-400 hover:text-white",children:e.jsx($,{size:18})}),e.jsx(w,{isOpen:u,onOpenChange:t,className:"border dark text-foreground border-default-400",children:e.jsx(_,{children:r=>e.jsxs(e.Fragment,{children:[e.jsx(k,{className:"flex flex-col gap-1 uppercase",children:"⚠️ Advertencia"}),e.jsxs(S,{children:[e.jsx("div",{children:"Esta acción es permanente y no se puede deshacer."}),e.jsx(b,{placeholder:"Nuevo nombre",label:"Nombre",isRequired:!0,variant:"underlined",...f("name")})]}),e.jsx(v,{children:e.jsx(g,{className:"uppercase font-semibold bg-primary/60 hover:bg-primary",variant:"solid",radius:"sm",onPress:()=>{p(n)(),r()},children:"Editar"})})]})})})]})}const J=[{label:"country",key:"name"},{label:"manager",key:"manager"},{label:"acciones",key:"actions"}],U=function(){const d=localStorage.getItem("apdcc_token"),{refresh:u,isHiddenTopBar:l}=x(),[t,f]=i.useState({docs:[],totalDocs:0,limit:10,totalPages:0,page:0,pagingCounter:0,hasPrevPage:!1,hasNextPage:!1,prevPage:null,nextPage:null}),[p,n]=i.useState([]),[r,s]=i.useState(!0),[c,P]=i.useState(1);i.useEffect(()=>{(async()=>{const o=`https://apdcc-back-production.up.railway.app/api/countries?page=${c}`;try{const h=await fetch(o,{method:"GET",credentials:"include",headers:{token:d}});if(h.ok){const O=await h.json();f(O.response)}}catch(h){throw new Error(h)}finally{s(!1)}})()},[c,u]);const E=a=>{const o=t.docs.filter(h=>h.name.toLowerCase().includes(a.toLowerCase()));o.length&&n(o)};return e.jsxs("section",{className:` ${l?"pt-12":"pt-36"} absolute top-0 left-0 w-full pl-5 lg:pl-[200px] pb-16 lg:pt-20 pr-5 overflow-y-scroll h-screen bg-black`,children:[e.jsxs("div",{className:"flex flex-wrap items-start justify-between w-full gap-4 pb-4 ",children:[e.jsx(B,{}),e.jsx(b,{startContent:e.jsx(F,{}),type:"search",size:"sm",variant:"underlined",placeholder:"Buscar",color:"warning",className:"w-[180px]",onChange:a=>{var o;return E((o=a.target)==null?void 0:o.value)}})]}),e.jsxs("div",{className:"flex items-center justify-between px-3",children:[e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["Total ",t.totalDocs," countries"]}),e.jsxs("p",{className:"mb-2 text-default-400 text-small",children:["Página ",t.page]})]}),e.jsxs(I,{"aria-label":"Users Table",bottomContent:t.page>0?e.jsx("div",{className:`${t.docs?"opacity-100":"opacity-0"} flex items-center justify-center w-full gap-4`,children:e.jsx(D,{isCompact:!0,showControls:!0,showShadow:!0,color:"primary",page:t.page,total:t.totalPages,onChange:a=>P(a)})}):null,children:[e.jsx(L,{columns:J,children:a=>e.jsx(A,{className:"uppercase",allowsSorting:a.key!=="country"&&a.key!=="actions",children:a.label},a.key)}),e.jsx(M,{emptyContent:r?" ":t.docs.length===0?"No se encontraron countries":"",items:p.length?p:t.docs,isLoading:r,loadingContent:e.jsx(j,{className:"mt-12",label:"Loading..."}),children:a=>e.jsx(R,{children:o=>e.jsxs(z,{className:"capitalize",children:[o==="manager"&&e.jsx(V,{id:a._id}),o==="actions"?e.jsx("div",{className:"flex items-center gap-3",children:e.jsx(G,{id:a._id})}):q(a,o)]})},a.name)})]})]})},de=U;export{de as default};
